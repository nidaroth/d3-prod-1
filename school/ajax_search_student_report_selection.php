<? require_once("../common_classes/apc_cache.php");
require_once("../global/config.php");
require_once("../language/common.php");
require_once("../language/menu.php");
require_once("../language/student.php");
require_once("../language/student_report_selection.php");
require_once("../language/student_contact.php");
require_once("check_access.php");
ini_set('memory_limit', '400M');
// ENABLE_DEBUGGING(true);
if (check_access('REPORT_CUSTOM_REPORT') == 0) {
	header("location:../index");
	exit;
}

$table = "";
$cond 	= "";
// apcu_clear_cache();
// print_r($_REQUEST['enrollment_type']);
// print_r($_REQUEST['student_type']);
// exit;
if ($_REQUEST['id'] != '') {
	$res_type = $db->Execute("SELECT PK_STUDENT_ENROLLMENT from S_SELECT_STUDENT_FILTER WHERE PK_SELECT_STUDENT_FILTER = '$_REQUEST[id]' AND PK_USER = '$_SESSION[PK_USER]' ");
	$PK_STUDENT_ENROLLMENT_ARR 	= explode(",", $res_type->fields['PK_STUDENT_ENROLLMENT']);
} else
	$PK_STUDENT_ENROLLMENT_ARR = array();

if ($_REQUEST['PK_CITIZENSHIP'] != '')
	$cond .= " AND PK_CITIZENSHIP IN ($_REQUEST[PK_CITIZENSHIP]) ";

if ($_REQUEST['PK_COUNTRY_CITIZEN'] != '')
	$cond .= " AND PK_COUNTRY_CITIZEN IN ($_REQUEST[PK_COUNTRY_CITIZEN]) ";

if ($_REQUEST['DOB_START_DATE'] != '' && $_REQUEST['DOB_END_DATE'] != '') {
	$DOB_START_DATE = date("Y-m-d", strtotime($_REQUEST['DOB_START_DATE']));
	$DOB_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DOB_END_DATE']));
	$cond .= " AND DATE_OF_BIRTH BETWEEN '$DOB_START_DATE' AND '$DOB_END_DATE' ";
} else if ($_REQUEST['DOB_START_DATE'] != '') {
	$DOB_START_DATE = date("Y-m-d", strtotime($_REQUEST['DOB_START_DATE']));
	$cond .= " AND DATE_OF_BIRTH >= '$DOB_START_DATE' ";
} else if ($_REQUEST['DOB_END_DATE'] != '') {
	$DOB_END_DATE = date("Y-m-d", strtotime($_REQUEST['DOB_END_DATE']));
	$cond .= " AND DATE_OF_BIRTH <= '$DOB_END_DATE' ";
}

if ($_REQUEST['PK_DRIVERS_LICENSE_STATE'] != '')
	$cond .= " AND PK_DRIVERS_LICENSE_STATE IN ($_REQUEST[PK_DRIVERS_LICENSE_STATE]) ";

if ($_REQUEST['FERPA_BLOCK'] != '')
	$cond .= " AND FERPA_BLOCK IN ($_REQUEST[FERPA_BLOCK]) ";

if ($_REQUEST['GENDER'] != '')
	$cond .= " AND GENDER IN ($_REQUEST[GENDER]) ";

if ($_REQUEST['PK_HIGHEST_LEVEL_OF_EDU'] != '')
	$cond .= " AND PK_HIGHEST_LEVEL_OF_EDU IN ($_REQUEST[PK_HIGHEST_LEVEL_OF_EDU]) ";

if ($_REQUEST['IPEDS_ETHNICITY'] != '')
	$cond .= " AND IPEDS_ETHNICITY = '$_REQUEST[IPEDS_ETHNICITY]' ";

if ($_REQUEST['PK_MARITAL_STATUS'] != '')
	$cond .= " AND PK_MARITAL_STATUS IN ($_REQUEST[PK_MARITAL_STATUS]) ";

if ($_REQUEST['PREVIOUS_COLLEGE'] != '')
	$cond .= " AND PREVIOUS_COLLEGE IN ($_REQUEST[PREVIOUS_COLLEGE]) ";

if ($_REQUEST['PK_RACE'] != '')
	$cond .= " AND PK_RACE IN ($_REQUEST[PK_RACE]) ";

if ($_REQUEST['SSN_VERIFIED'] != '')
	$cond .= " AND SSN_VERIFIED IN ($_REQUEST[SSN_VERIFIED]) ";

if ($_REQUEST['PK_STATE_OF_RESIDENCY'] != '')
	$cond .= " AND PK_STATE_OF_RESIDENCY IN ($_REQUEST[PK_STATE_OF_RESIDENCY]) ";

////////////////////////////	
if ($_REQUEST['PK_1098T_REPORTING_TYPE'] != '')
	$cond .= " AND PK_1098T_REPORTING_TYPE IN ($_REQUEST[PK_1098T_REPORTING_TYPE]) ";

if ($_REQUEST['PK_REPRESENTATIVE'] != '')
	$cond .= " AND PK_REPRESENTATIVE IN ($_REQUEST[PK_REPRESENTATIVE]) ";

if ($_REQUEST['ATTENDANCE_BEGIN_DATE'] != '' && $_REQUEST['ATTENDANCE_END_DATE'] != '') {
	$ATTENDANCE_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ATTENDANCE_BEGIN_DATE']));
	$ATTENDANCE_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['ATTENDANCE_END_DATE']));

	$table .= ", S_STUDENT_ATTENDANCE";
	$cond .= " AND S_STUDENT_ATTENDANCE.PK_STUDENT_SCHEDULE = S_STUDENT_SCHEDULE.PK_STUDENT_SCHEDULE AND SCHEDULE_DATE BETWEEN '$ATTENDANCE_BEGIN_DATE' AND '$ATTENDANCE_END_DATE' ";
} else if ($_REQUEST['ATTENDANCE_BEGIN_DATE'] != '') {
	$ATTENDANCE_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ATTENDANCE_BEGIN_DATE']));

	$table .= ", S_STUDENT_ATTENDANCE";
	$cond .= " AND S_STUDENT_ATTENDANCE.PK_STUDENT_SCHEDULE = S_STUDENT_SCHEDULE.PK_STUDENT_SCHEDULE AND SCHEDULE_DATE >= '$ATTENDANCE_BEGIN_DATE' ";
} else if ($_REQUEST['ATTENDANCE_END_DATE'] != '') {
	$ATTENDANCE_END_DATE = date("Y-m-d", strtotime($_REQUEST['ATTENDANCE_END_DATE']));

	$table .= ",S_STUDENT_ATTENDANCE ";
	$cond .= " AND S_STUDENT_ATTENDANCE.PK_STUDENT_SCHEDULE = S_STUDENT_SCHEDULE.PK_STUDENT_SCHEDULE AND SCHEDULE_DATE <= '$ATTENDANCE_END_DATE' ";
}

// if ($_REQUEST['ATTENDANCE_END_DATE'] != '' || $_REQUEST['ATTENDANCE_BEGIN_DATE']) {
// 	$joins = ' ';
// }

if ($_REQUEST['PK_CAMPUS'] != '') {
	// NO NEED , this lin uneccessarily includes campus table in cross join, already joined below $table .= ",S_STUDENT_CAMPUS ";
	$cond .= " AND PK_CAMPUS IN ($_REQUEST[PK_CAMPUS]) ";
}

if ($_REQUEST['PK_SPECIAL'] != '')
	$cond .= " AND PK_SPECIAL IN ($_REQUEST[PK_SPECIAL]) ";

if ($_REQUEST['PK_LEAD_CONTACT_SOURCE'] != '')
	$cond .= " AND PK_LEAD_CONTACT_SOURCE IN ($_REQUEST[PK_LEAD_CONTACT_SOURCE]) ";

if ($_REQUEST['CONTRACT_END_DATE_BEGIN'] != '' && $_REQUEST['ATTENDANCE_END_DATE'] != '') {
	$CONTRACT_END_DATE_BEGIN = date("Y-m-d", strtotime($_REQUEST['CONTRACT_END_DATE_BEGIN']));
	$ATTENDANCE_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['ATTENDANCE_END_DATE']));

	$cond .= " AND CONTRACT_END_DATE BETWEEN '$CONTRACT_END_DATE_BEGIN' AND '$ATTENDANCE_END_DATE' ";
} else if ($_REQUEST['CONTRACT_END_DATE_BEGIN'] != '') {
	$CONTRACT_END_DATE_BEGIN = date("Y-m-d", strtotime($_REQUEST['CONTRACT_END_DATE_BEGIN']));

	$cond .= " AND CONTRACT_END_DATE >= '$CONTRACT_END_DATE_BEGIN' ";
} else if ($_REQUEST['ATTENDANCE_END_DATE'] != '') {
	$ATTENDANCE_END_DATE = date("Y-m-d", strtotime($_REQUEST['ATTENDANCE_END_DATE']));

	$cond .= " AND CONTRACT_END_DATE <= '$ATTENDANCE_END_DATE' ";
}

//DIAM-1106


if ($_REQUEST['CONTRACT_END_DATE_END'] != '' && $_REQUEST['ATTENDANCE_END_DATE'] != '') {
	$CONTRACT_END_DATE_END = date("Y-m-d", strtotime($_REQUEST['CONTRACT_END_DATE_END']));
	$ATTENDANCE_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['ATTENDANCE_END_DATE']));

	$cond .= " AND CONTRACT_END_DATE BETWEEN '$ATTENDANCE_END_DATE' AND'$CONTRACT_END_DATE_END'  ";
} else if ($_REQUEST['CONTRACT_END_DATE_END'] != '') {
	$CONTRACT_END_DATE_END = date("Y-m-d", strtotime($_REQUEST['CONTRACT_END_DATE_END']));

	$cond .= " AND CONTRACT_END_DATE <= '$CONTRACT_END_DATE_END' ";
} else if ($_REQUEST['ATTENDANCE_END_DATE'] != '') {
	$ATTENDANCE_END_DATE = date("Y-m-d", strtotime($_REQUEST['ATTENDANCE_END_DATE']));

	$cond .= " AND CONTRACT_END_DATE >= '$ATTENDANCE_END_DATE' ";
}
//END OF DIAM-1106

if ($_REQUEST['CONTRACT_SIGNED_BEGIN_DATE'] != '' && $_REQUEST['CONTRACT_SIGNED_END_DATE'] != '') {
	$CONTRACT_SIGNED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['CONTRACT_SIGNED_BEGIN_DATE']));
	$CONTRACT_SIGNED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['CONTRACT_SIGNED_END_DATE']));

	$cond .= " AND CONTRACT_SIGNED_DATE BETWEEN '$CONTRACT_SIGNED_BEGIN_DATE' AND '$CONTRACT_SIGNED_END_DATE' ";
} else if ($_REQUEST['CONTRACT_SIGNED_BEGIN_DATE'] != '') {
	$CONTRACT_SIGNED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['CONTRACT_SIGNED_BEGIN_DATE']));

	$cond .= " AND CONTRACT_SIGNED_DATE >= '$CONTRACT_SIGNED_BEGIN_DATE' ";
} else if ($_REQUEST['CONTRACT_SIGNED_END_DATE'] != '') {
	$CONTRACT_SIGNED_END_DATE = date("Y-m-d", strtotime($_REQUEST['CONTRACT_SIGNED_END_DATE']));

	$cond .= " AND CONTRACT_SIGNED_DATE <= '$CONTRACT_SIGNED_END_DATE' ";
}

if ($_REQUEST['DETERMINATION_BEGIN_DATE'] != '' && $_REQUEST['DETERMINATION_END_DATE'] != '') {
	$DETERMINATION_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['DETERMINATION_BEGIN_DATE']));
	$DETERMINATION_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DETERMINATION_END_DATE']));

	$cond .= " AND DETERMINATION_DATE BETWEEN '$DETERMINATION_BEGIN_DATE' AND '$DETERMINATION_END_DATE' ";
} else if ($_REQUEST['DETERMINATION_BEGIN_DATE'] != '') {
	$DETERMINATION_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DETERMINATION_BEGIN_DATE']));

	$cond .= " AND DETERMINATION_DATE >= '$DETERMINATION_BEGIN_DATE' ";
} else if ($_REQUEST['DETERMINATION_END_DATE'] != '') {
	$DETERMINATION_END_DATE = date("Y-m-d", strtotime($_REQUEST['DETERMINATION_END_DATE']));

	$cond .= " AND DETERMINATION_DATE <= '$DETERMINATION_END_DATE' ";
}

if ($_REQUEST['PK_DISTANCE_LEARNING'] != '')
	$cond .= " AND PK_DISTANCE_LEARNING IN ($_REQUEST[PK_DISTANCE_LEARNING]) ";

if ($_REQUEST['DROP_BEGIN_DATE'] != '' && $_REQUEST['DROP_END_DATE'] != '') {
	$DROP_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['DROP_BEGIN_DATE']));
	$DROP_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DROP_END_DATE']));

	$cond .= " AND DROP_DATE BETWEEN '$DROP_BEGIN_DATE' AND '$DROP_END_DATE' ";
} else if ($_REQUEST['DROP_BEGIN_DATE'] != '') {
	$DROP_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DROP_BEGIN_DATE']));

	$cond .= " AND DROP_DATE >= '$DROP_BEGIN_DATE' ";
} else if ($_REQUEST['DROP_END_DATE'] != '') {
	$DROP_END_DATE = date("Y-m-d", strtotime($_REQUEST['DROP_END_DATE']));

	$cond .= " AND DROP_DATE <= '$DROP_END_DATE' ";
}

if ($_REQUEST['PK_DROP_REASON'] != '')
	$cond .= " AND PK_DROP_REASON IN ($_REQUEST[PK_DROP_REASON]) ";

if ($_REQUEST['EXPECTED_GRAD_BEGIN_DATE'] != '' && $_REQUEST['EXPECTED_GRAD_END_DATE'] != '') {
	$EXPECTED_GRAD_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['EXPECTED_GRAD_BEGIN_DATE']));
	$EXPECTED_GRAD_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['EXPECTED_GRAD_END_DATE']));

	$cond .= " AND EXPECTED_GRAD_DATE BETWEEN '$EXPECTED_GRAD_BEGIN_DATE' AND '$EXPECTED_GRAD_END_DATE' ";
} else if ($_REQUEST['EXPECTED_GRAD_BEGIN_DATE'] != '') {
	$EXPECTED_GRAD_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['EXPECTED_GRAD_BEGIN_DATE']));

	$cond .= " AND EXPECTED_GRAD_DATE >= '$EXPECTED_GRAD_BEGIN_DATE' ";
} else if ($_REQUEST['EXPECTED_GRAD_END_DATE'] != '') {
	$EXPECTED_GRAD_END_DATE = date("Y-m-d", strtotime($_REQUEST['EXPECTED_GRAD_END_DATE']));

	$cond .= " AND EXPECTED_GRAD_DATE <= '$EXPECTED_GRAD_END_DATE' ";
}

if ($_REQUEST['TERM_BEGIN_DATE'] != '' && $_REQUEST['TERM_END_DATE'] != '') {
	$TERM_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['TERM_BEGIN_DATE']));
	$TERM_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['TERM_END_DATE']));

	$cond .= " AND S_TERM_MASTER.BEGIN_DATE BETWEEN '$TERM_BEGIN_DATE' AND '$TERM_END_DATE' ";
} else if ($_REQUEST['TERM_BEGIN_DATE'] != '') {
	$TERM_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['TERM_BEGIN_DATE']));

	$cond .= " AND S_TERM_MASTER.BEGIN_DATE >= '$TERM_BEGIN_DATE' ";
} else if ($_REQUEST['TERM_END_DATE'] != '') {
	$TERM_END_DATE = date("Y-m-d", strtotime($_REQUEST['TERM_END_DATE']));

	$cond .= " AND S_TERM_MASTER.BEGIN_DATE <= '$TERM_END_DATE' ";
}

if ($_REQUEST['FT_PT_EFFECTIVE_BEGIN_DATE'] != '' && $_REQUEST['FT_PT_EFFECTIVE_END_DATE'] != '') {
	$FT_PT_EFFECTIVE_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['FT_PT_EFFECTIVE_BEGIN_DATE']));
	$FT_PT_EFFECTIVE_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['FT_PT_EFFECTIVE_END_DATE']));

	$cond .= " AND FT_PT_EFFECTIVE_DATE BETWEEN '$FT_PT_EFFECTIVE_BEGIN_DATE' AND '$FT_PT_EFFECTIVE_END_DATE' ";
} else if ($_REQUEST['FT_PT_EFFECTIVE_BEGIN_DATE'] != '') {
	$FT_PT_EFFECTIVE_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['FT_PT_EFFECTIVE_BEGIN_DATE']));

	$cond .= " AND FT_PT_EFFECTIVE_DATE >= '$FT_PT_EFFECTIVE_BEGIN_DATE' ";
} else if ($_REQUEST['FT_PT_EFFECTIVE_END_DATE'] != '') {
	$FT_PT_EFFECTIVE_END_DATE = date("Y-m-d", strtotime($_REQUEST['FT_PT_EFFECTIVE_END_DATE']));

	$cond .= " AND FT_PT_EFFECTIVE_DATE <= '$FT_PT_EFFECTIVE_END_DATE' ";
}

if ($_REQUEST['PK_ENROLLMENT_STATUS'] != '')
	$cond .= " AND PK_ENROLLMENT_STATUS IN ($_REQUEST[PK_ENROLLMENT_STATUS]) ";

if ($_REQUEST['PK_FUNDING'] != '')
	$cond .= " AND PK_FUNDING IN ($_REQUEST[PK_FUNDING]) ";

if ($_REQUEST['GRADE_BEGIN_DATE'] != '' && $_REQUEST['GRADE_END_DATE'] != '') {
	$GRADE_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['GRADE_BEGIN_DATE']));
	$GRADE_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['GRADE_END_DATE']));

	$cond .= " AND GRADE_DATE BETWEEN '$GRADE_BEGIN_DATE' AND '$GRADE_END_DATE' ";
} else if ($_REQUEST['GRADE_BEGIN_DATE'] != '') {
	$GRADE_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['GRADE_BEGIN_DATE']));

	$cond .= " AND GRADE_DATE >= '$GRADE_BEGIN_DATE' ";
} else if ($_REQUEST['GRADE_END_DATE'] != '') {
	$GRADE_END_DATE = date("Y-m-d", strtotime($_REQUEST['GRADE_END_DATE']));

	$cond .= " AND GRADE_DATE <= '$GRADE_END_DATE' ";
}

if ($_REQUEST['FIRST_TERM'] != '')
	$cond .= " AND FIRST_TERM IN ($_REQUEST[FIRST_TERM]) ";

if ($_REQUEST['LDA_BEGIN_DATE'] != '' && $_REQUEST['LDA_END_DATE'] != '') {
	$LDA_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['LDA_BEGIN_DATE']));
	$LDA_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['LDA_END_DATE']));

	$cond .= " AND LDA BETWEEN '$LDA_BEGIN_DATE' AND '$LDA_END_DATE' ";
} else if ($_REQUEST['LDA_BEGIN_DATE'] != '') {
	$LDA_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['LDA_BEGIN_DATE']));

	$cond .= " AND LDA >= '$LDA_BEGIN_DATE' ";
} else if ($_REQUEST['LDA_END_DATE'] != '') {
	$LDA_END_DATE = date("Y-m-d", strtotime($_REQUEST['LDA_END_DATE']));

	$cond .= " AND LDA <= '$LDA_END_DATE' ";
}

if ($_REQUEST['ENTRY_BEGIN_DATE'] != '' && $_REQUEST['ENTRY_END_DATE'] != '') {
	$ENTRY_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['ENTRY_BEGIN_DATE']));
	$ENTRY_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['ENTRY_END_DATE']));

	$cond .= " AND ENTRY_DATE BETWEEN '$ENTRY_BEGIN_DATE' AND '$ENTRY_END_DATE' ";
} else if ($_REQUEST['ENTRY_BEGIN_DATE'] != '') {
	$ENTRY_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ENTRY_BEGIN_DATE']));

	$cond .= " AND ENTRY_DATE >= '$ENTRY_BEGIN_DATE' ";
} else if ($_REQUEST['ENTRY_END_DATE'] != '') {
	$ENTRY_END_DATE = date("Y-m-d", strtotime($_REQUEST['ENTRY_END_DATE']));

	$cond .= " AND ENTRY_DATE <= '$ENTRY_END_DATE' ";
}

if ($_REQUEST['PK_LEAD_SOURCE'] != '')
	$cond .= " AND PK_LEAD_SOURCE IN ($_REQUEST[PK_LEAD_SOURCE]) ";

if ($_REQUEST['MIDPOINT_BEGIN_DATE'] != '' && $_REQUEST['MIDPOINT_END_DATE'] != '') {
	$MIDPOINT_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['MIDPOINT_BEGIN_DATE']));
	$MIDPOINT_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['MIDPOINT_END_DATE']));

	$cond .= " AND MIDPOINT_DATE BETWEEN '$MIDPOINT_BEGIN_DATE' AND '$MIDPOINT_END_DATE' ";
} else if ($_REQUEST['MIDPOINT_BEGIN_DATE'] != '') {
	$MIDPOINT_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['MIDPOINT_BEGIN_DATE']));

	$cond .= " AND MIDPOINT_DATE >= '$MIDPOINT_BEGIN_DATE' ";
} else if ($_REQUEST['MIDPOINT_END_DATE'] != '') {
	$MIDPOINT_END_DATE = date("Y-m-d", strtotime($_REQUEST['MIDPOINT_END_DATE']));

	$cond .= " AND MIDPOINT_DATE <= '$MIDPOINT_END_DATE' ";
}

if ($_REQUEST['ORIGINAL_EXPECTED_GRAD_BEGIN_DATE'] != '' && $_REQUEST['ORIGINAL_EXPECTED_GRAD_END_DATE'] != '') {
	$ORIGINAL_EXPECTED_GRAD_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['ORIGINAL_EXPECTED_GRAD_BEGIN_DATE']));
	$ORIGINAL_EXPECTED_GRAD_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['ORIGINAL_EXPECTED_GRAD_END_DATE']));

	$cond .= " AND ORIGINAL_EXPECTED_GRAD_DATE BETWEEN '$ORIGINAL_EXPECTED_GRAD_BEGIN_DATE' AND '$ORIGINAL_EXPECTED_GRAD_END_DATE' ";
} else if ($_REQUEST['ORIGINAL_EXPECTED_GRAD_BEGIN_DATE'] != '') {
	$ORIGINAL_EXPECTED_GRAD_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ORIGINAL_EXPECTED_GRAD_BEGIN_DATE']));

	$cond .= " AND ORIGINAL_EXPECTED_GRAD_DATE >= '$ORIGINAL_EXPECTED_GRAD_BEGIN_DATE' ";
} else if ($_REQUEST['ORIGINAL_EXPECTED_GRAD_END_DATE'] != '') {
	$ORIGINAL_EXPECTED_GRAD_END_DATE = date("Y-m-d", strtotime($_REQUEST['ORIGINAL_EXPECTED_GRAD_END_DATE']));

	$cond .= " AND ORIGINAL_EXPECTED_GRAD_DATE <= '$ORIGINAL_EXPECTED_GRAD_END_DATE' ";
}

if ($_REQUEST['PK_PLACEMENT_STATUS'] != '')
	$cond .= " AND PK_PLACEMENT_STATUS IN ($_REQUEST[PK_PLACEMENT_STATUS]) ";

if ($_REQUEST['PK_CAMPUS_PROGRAM'] != '')
	$cond .= " AND PK_CAMPUS_PROGRAM IN ($_REQUEST[PK_CAMPUS_PROGRAM]) ";

if ($_REQUEST['REENTRY'] == 1)
	$cond .= " AND REENTRY = 1 ";
else if ($_REQUEST['REENTRY'] == 2)
	$cond .= " AND REENTRY = 0 ";

if ($_REQUEST['PK_SAP_GROUP'] != '')
	$cond .= " AND PK_SAP_GROUP IN ($_REQUEST[PK_SAP_GROUP]) ";

if ($_REQUEST['PK_SESSION'] != '')
	$cond .= " AND PK_SESSION IN ($_REQUEST[PK_SESSION]) ";

if ($_REQUEST['PK_STUDENT_STATUS'] != '')
	$cond .= " AND S_STUDENT_ENROLLMENT.PK_STUDENT_STATUS IN ($_REQUEST[PK_STUDENT_STATUS]) ";

if ($_REQUEST['STATUS_BEGIN_DATE'] != '' && $_REQUEST['STATUS_END_DATE'] != '') {
	$STATUS_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['STATUS_BEGIN_DATE']));
	$STATUS_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['STATUS_END_DATE']));

	$cond .= " AND STATUS_DATE BETWEEN '$STATUS_BEGIN_DATE' AND '$STATUS_END_DATE' ";
} else if ($_REQUEST['STATUS_BEGIN_DATE'] != '') {
	$STATUS_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['STATUS_BEGIN_DATE']));

	$cond .= " AND STATUS_DATE >= '$STATUS_BEGIN_DATE' ";
} else if ($_REQUEST['STATUS_END_DATE'] != '') {
	$STATUS_END_DATE = date("Y-m-d", strtotime($_REQUEST['STATUS_END_DATE']));

	$cond .= " AND STATUS_DATE <= '$STATUS_END_DATE' ";
}

if ($_REQUEST['STRF_PAID_BEGIN_DATE'] != '' && $_REQUEST['STRF_PAID_END_DATE'] != '') {
	$STRF_PAID_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['STRF_PAID_BEGIN_DATE']));
	$STRF_PAID_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['STRF_PAID_END_DATE']));

	$cond .= " AND STRF_PAID_DATE BETWEEN '$STRF_PAID_BEGIN_DATE' AND '$STRF_PAID_END_DATE' ";
} else if ($_REQUEST['STRF_PAID_BEGIN_DATE'] != '') {
	$STRF_PAID_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['STRF_PAID_BEGIN_DATE']));

	$cond .= " AND STRF_PAID_DATE >= '$STRF_PAID_BEGIN_DATE' ";
} else if ($_REQUEST['STRF_PAID_END_DATE'] != '') {
	$STRF_PAID_END_DATE = date("Y-m-d", strtotime($_REQUEST['STRF_PAID_END_DATE']));

	$cond .= " AND STRF_PAID_DATE <= '$STRF_PAID_END_DATE' ";
}

if ($_REQUEST['PK_STUDENT_GROUP'] != '')
	$cond .= " AND PK_STUDENT_GROUP IN ($_REQUEST[PK_STUDENT_GROUP]) ";

if ($_REQUEST['ENROLLMENT_PK_TERM_BLOCK'] != '')
	$cond .= " AND ENROLLMENT_PK_TERM_BLOCK IN ($_REQUEST[ENROLLMENT_PK_TERM_BLOCK]) ";

if ($_REQUEST['TRANSFER_IN'] == 1)
	$cond .= " AND TRANSFER_IN = 1 ";
else if ($_REQUEST['TRANSFER_IN'] == 2)
	$cond .= " AND TRANSFER_IN = 0 ";

if ($_REQUEST['TRANSFER_OUT'] == 1)
	$cond .= " AND TRANSFER_OUT = 1 ";
else if ($_REQUEST['TRANSFER_OUT'] == 2)
	$cond .= " AND TRANSFER_OUT = 0 ";


if ($_REQUEST['EMAIL_SENT_ON_BEGIN_DATE'] != '' && $_REQUEST['EMAIL_SENT_ON_END_DATE'] != '') {
	$EMAIL_SENT_ON_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['EMAIL_SENT_ON_BEGIN_DATE']));
	$EMAIL_SENT_ON_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['EMAIL_SENT_ON_END_DATE']));

	$table .= ", S_EMAIL_LOG";
	$cond .= " AND S_EMAIL_LOG.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT AND DATE_FORMAT(S_EMAIL_LOG.SENT_ON, '%Y-%m-%d') BETWEEN '$EMAIL_SENT_ON_BEGIN_DATE' AND '$EMAIL_SENT_ON_END_DATE' ";
} else if ($_REQUEST['EMAIL_SENT_ON_BEGIN_DATE'] != '') {
	$EMAIL_SENT_ON_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['EMAIL_SENT_ON_BEGIN_DATE']));

	$table .= ", S_EMAIL_LOG";
	$cond .= " AND S_EMAIL_LOG.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT  AND DATE_FORMAT(S_EMAIL_LOG.SENT_ON, '%Y-%m-%d') >= '$EMAIL_SENT_ON_BEGIN_DATE' ";
} else if ($_REQUEST['EMAIL_SENT_ON_END_DATE'] != '') {
	$EMAIL_SENT_ON_END_DATE = date("Y-m-d", strtotime($_REQUEST['EMAIL_SENT_ON_END_DATE']));

	$table .= ",S_EMAIL_LOG ";
	$cond .= " AND S_EMAIL_LOG.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT  AND DATE_FORMAT(S_EMAIL_LOG.SENT_ON, '%Y-%m-%d') <= '$EMAIL_SENT_ON_END_DATE' ";
}

if ($_REQUEST['EVENT_COMPLETED'] != '' || $_REQUEST['EVENT_BEGIN_DATE'] != '' || $_REQUEST['EVENT_END_DATE'] != '' || $_REQUEST['EVENT_EMPLOYEE'] != '' || $_REQUEST['EVENT_FOLLOWUP_BEGIN_DATE'] != '' || $_REQUEST['EVENT_FOLLOWUP_END_DATE'] != '' || $_REQUEST['EVENT_OTHER'] != '' || $_REQUEST['EVENT_STATUS'] != '' || $_REQUEST['EVENT_TYPE'] != '') {
	$table .= ", S_STUDENT_NOTES as S_STUDENT_EVENT ";
	$cond .= " AND S_STUDENT_EVENT.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT AND S_STUDENT_EVENT.IS_EVENT = 1 ";
}

if ($_REQUEST['EVENT_COMPLETED'] == 1)
	$cond .= " AND S_STUDENT_EVENT.SATISFIED = 1 ";
else if ($_REQUEST['EVENT_COMPLETED'] == 2)
	$cond .= " AND S_STUDENT_EVENT.SATISFIED = 0 ";

if ($_REQUEST['EVENT_BEGIN_DATE'] != '' && $_REQUEST['EVENT_END_DATE'] != '') {
	$EVENT_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['EVENT_BEGIN_DATE']));
	$EVENT_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['EVENT_END_DATE']));

	$cond .= " AND S_STUDENT_EVENT.NOTE_DATE BETWEEN '$EVENT_BEGIN_DATE' AND '$EVENT_END_DATE' ";
} else if ($_REQUEST['EVENT_BEGIN_DATE'] != '') {
	$EVENT_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['EVENT_BEGIN_DATE']));

	$cond .= " AND S_STUDENT_EVENT.NOTE_DATE >= '$EVENT_BEGIN_DATE' ";
} else if ($_REQUEST['EVENT_END_DATE'] != '') {
	$EVENT_END_DATE = date("Y-m-d", strtotime($_REQUEST['EVENT_END_DATE']));

	$cond .= " AND S_STUDENT_EVENT.NOTE_DATE <= '$EVENT_END_DATE' ";
}


if ($_REQUEST['EVENT_EMPLOYEE'] != '')
	$cond .= " AND S_STUDENT_EVENT.PK_EMPLOYEE_MASTER IN ($_REQUEST[EVENT_EMPLOYEE]) ";

if ($_REQUEST['EVENT_FOLLOWUP_BEGIN_DATE'] != '' && $_REQUEST['EVENT_FOLLOWUP_END_DATE'] != '') {
	$EVENT_FOLLOWUP_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['EVENT_FOLLOWUP_BEGIN_DATE']));
	$EVENT_FOLLOWUP_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['EVENT_FOLLOWUP_END_DATE']));

	$cond .= " AND S_STUDENT_EVENT.NOTE_DATE BETWEEN '$EVENT_FOLLOWUP_BEGIN_DATE' AND '$EVENT_FOLLOWUP_END_DATE' ";
} else if ($_REQUEST['EVENT_FOLLOWUP_BEGIN_DATE'] != '') {
	$EVENT_FOLLOWUP_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['EVENT_FOLLOWUP_BEGIN_DATE']));

	$cond .= " AND S_STUDENT_EVENT.NOTE_DATE >= '$EVENT_FOLLOWUP_BEGIN_DATE' ";
} else if ($_REQUEST['EVENT_FOLLOWUP_END_DATE'] != '') {
	$EVENT_FOLLOWUP_END_DATE = date("Y-m-d", strtotime($_REQUEST['EVENT_FOLLOWUP_END_DATE']));

	$cond .= " AND S_STUDENT_EVENT.NOTE_DATE <= '$EVENT_FOLLOWUP_END_DATE' ";
}

if ($_REQUEST['EVENT_OTHER'] != '')
	$cond .= " AND S_STUDENT_EVENT.PK_EVENT_OTHER IN ($_REQUEST[EVENT_OTHER]) ";

if ($_REQUEST['EVENT_STATUS'] != '')
	$cond .= " AND S_STUDENT_EVENT.PK_NOTE_STATUS IN ($_REQUEST[EVENT_STATUS]) ";

if ($_REQUEST['EVENT_TYPE'] != '')
	$cond .= " AND S_STUDENT_EVENT.PK_NOTE_TYPE IN ($_REQUEST[EVENT_TYPE]) ";

if ($_REQUEST['INTERNAL_MSG_SENT_FROM'] != '' || $_REQUEST['INTERNAL_MSG_SENT_ON_BEGIN_DATE'] != '' || $_REQUEST['INTERNAL_MSG_SENT_ON_END_DATE'] != '') {
	$table .= ", Z_INTERNAL_EMAIL, Z_INTERNAL_EMAIL_RECEPTION, Z_USER ";
	$cond .= " AND Z_INTERNAL_EMAIL.PK_INTERNAL_EMAIL = Z_INTERNAL_EMAIL_RECEPTION.PK_INTERNAL_EMAIL AND Z_INTERNAL_EMAIL_RECEPTION.PK_USER = Z_USER.PK_USER AND PK_USER_TYPE = 3 AND Z_USER.ID = S_STUDENT_MASTER.PK_STUDENT_MASTER ";
}

if ($_REQUEST['INTERNAL_MSG_SENT_FROM'] != '') {
	$cond .= " AND Z_INTERNAL_EMAIL.CREATED_BY IN ($_REQUEST[INTERNAL_MSG_SENT_FROM]) AND DRAFT = 0 AND PARENT_ID = 0 ";
}

if ($_REQUEST['INTERNAL_MSG_SENT_ON_BEGIN_DATE'] != '' && $_REQUEST['INTERNAL_MSG_SENT_ON_END_DATE'] != '') {
	$INTERNAL_MSG_SENT_ON_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['INTERNAL_MSG_SENT_ON_BEGIN_DATE']));
	$INTERNAL_MSG_SENT_ON_END_DATE 		= date("Y-m-d", strtotime($_REQUEST['INTERNAL_MSG_SENT_ON_END_DATE']));

	$cond .= " AND DATE_FORMAT(Z_INTERNAL_EMAIL.CREATED_ON, '%Y-%m-%d') BETWEEN '$INTERNAL_MSG_SENT_ON_BEGIN_DATE' AND '$INTERNAL_MSG_SENT_ON_END_DATE' ";
} else if ($_REQUEST['INTERNAL_MSG_SENT_ON_BEGIN_DATE'] != '') {
	$INTERNAL_MSG_SENT_ON_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['INTERNAL_MSG_SENT_ON_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(Z_INTERNAL_EMAIL.CREATED_ON, '%Y-%m-%d') >= '$INTERNAL_MSG_SENT_ON_BEGIN_DATE' ";
} else if ($_REQUEST['INTERNAL_MSG_SENT_ON_END_DATE'] != '') {
	$INTERNAL_MSG_SENT_ON_END_DATE = date("Y-m-d", strtotime($_REQUEST['INTERNAL_MSG_SENT_ON_END_DATE']));

	$cond .= " AND DATE_FORMAT(Z_INTERNAL_EMAIL.CREATED_ON, '%Y-%m-%d') <= '$INTERNAL_MSG_SENT_ON_END_DATE' ";
}

if ($_REQUEST['LOA_BEGIN_DATE'] != '' || $_REQUEST['LOA_END_DATE'] != '' || $_REQUEST['LOA_NO_OF_DAYS_FROM'] != '' || $_REQUEST['LOA_NO_OF_DAYS_TO'] != '') {
	$table .= ", S_STUDENT_LOA ";
	$cond .= " AND S_STUDENT_LOA.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}

if ($_REQUEST['LOA_BEGIN_DATE'] != '' && $_REQUEST['LOA_END_DATE'] != '') {
	$LOA_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['LOA_BEGIN_DATE']));
	$LOA_END_DATE 		= date("Y-m-d", strtotime($_REQUEST['LOA_END_DATE']));

	$cond .= " AND S_STUDENT_LOA.BEGIN_DATE BETWEEN '$LOA_BEGIN_DATE' AND '$LOA_END_DATE' ";
} else if ($_REQUEST['LOA_BEGIN_DATE'] != '') {
	$LOA_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['LOA_BEGIN_DATE']));

	$cond .= " AND S_STUDENT_LOA.BEGIN_DATE >= '$LOA_BEGIN_DATE' ";
} else if ($_REQUEST['LOA_END_DATE'] != '') {
	$LOA_END_DATE = date("Y-m-d", strtotime($_REQUEST['LOA_END_DATE']));

	$cond .= " AND S_STUDENT_LOA.BEGIN_DATE <= '$LOA_END_DATE' ";
}

if ($_REQUEST['LOA_NO_OF_DAYS_FROM'] != '' && $_REQUEST['LOA_NO_OF_DAYS_TO'] != '') {
	$cond .= " AND DATEDIFF(S_STUDENT_LOA.END_DATE, S_STUDENT_LOA.BEGIN_DATE) BETWEEN $_REQUEST[LOA_NO_OF_DAYS_FROM] AND $_REQUEST[LOA_NO_OF_DAYS_TO] ";
} else if ($_REQUEST['LOA_NO_OF_DAYS_FROM'] != '') {
	$cond .= " AND DATEDIFF(S_STUDENT_LOA.END_DATE, S_STUDENT_LOA.BEGIN_DATE) >= $_REQUEST[LOA_NO_OF_DAYS_FROM] ";
} else if ($_REQUEST['LOA_NO_OF_DAYS_TO'] != '') {
	$cond .= " AND DATEDIFF(S_STUDENT_LOA.END_DATE, S_STUDENT_LOA.BEGIN_DATE) <= $_REQUEST[LOA_NO_OF_DAYS_TO] ";
}

if ($_REQUEST['NOTES_COMPLETED'] != '' || $_REQUEST['NOTE_BEGIN_DATE'] != '' || $_REQUEST['NOTE_END_DATE'] != '' || $_REQUEST['NOTES_EMPLOYEE'] != '' || $_REQUEST['NOTES_FOLLOWUP_BEGIN_DATE'] != '' || $_REQUEST['NOTES_FOLLOWUP_END_DATE'] != '' || $_REQUEST['NOTE_STATUS'] != '' || $_REQUEST['NOTE_TYPE'] != '') {
	$table .= ", S_STUDENT_NOTES ";
	$cond .= " AND S_STUDENT_NOTES.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT AND S_STUDENT_NOTES.IS_EVENT = 0 ";
}

if ($_REQUEST['NOTES_COMPLETED'] == 1)
	$cond .= " AND S_STUDENT_NOTES.SATISFIED = 1 ";
else if ($_REQUEST['NOTES_COMPLETED'] == 2)
	$cond .= " AND S_STUDENT_NOTES.SATISFIED = 0 ";

if ($_REQUEST['NOTE_BEGIN_DATE'] != '' && $_REQUEST['NOTE_END_DATE'] != '') {
	$NOTE_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['NOTE_BEGIN_DATE']));
	$NOTE_END_DATE 		= date("Y-m-d", strtotime($_REQUEST['NOTE_END_DATE']));

	$cond .= " AND S_STUDENT_NOTES.NOTE_DATE BETWEEN '$NOTE_BEGIN_DATE' AND '$NOTE_END_DATE' ";
} else if ($_REQUEST['NOTE_BEGIN_DATE'] != '') {
	$NOTE_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['NOTE_BEGIN_DATE']));

	$cond .= " AND S_STUDENT_NOTES.NOTE_DATE >= '$NOTE_BEGIN_DATE' ";
} else if ($_REQUEST['NOTE_END_DATE'] != '') {
	$NOTE_END_DATE = date("Y-m-d", strtotime($_REQUEST['NOTE_END_DATE']));

	$cond .= " AND S_STUDENT_NOTES.NOTE_DATE <= '$NOTE_END_DATE' ";
}


if ($_REQUEST['NOTES_EMPLOYEE'] != '')
	$cond .= " AND S_STUDENT_NOTES.PK_EMPLOYEE_MASTER IN ($_REQUEST[NOTES_EMPLOYEE]) ";

if ($_REQUEST['NOTES_FOLLOWUP_BEGIN_DATE'] != '' && $_REQUEST['NOTES_FOLLOWUP_END_DATE'] != '') {
	$NOTES_FOLLOWUP_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['NOTES_FOLLOWUP_BEGIN_DATE']));
	$NOTES_FOLLOWUP_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['NOTES_FOLLOWUP_END_DATE']));

	$cond .= " AND S_STUDENT_NOTES.NOTE_DATE BETWEEN '$NOTES_FOLLOWUP_BEGIN_DATE' AND '$NOTES_FOLLOWUP_END_DATE' ";
} else if ($_REQUEST['NOTES_FOLLOWUP_BEGIN_DATE'] != '') {
	$NOTES_FOLLOWUP_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['NOTES_FOLLOWUP_BEGIN_DATE']));

	$cond .= " AND S_STUDENT_NOTES.NOTE_DATE >= '$NOTES_FOLLOWUP_BEGIN_DATE' ";
} else if ($_REQUEST['NOTES_FOLLOWUP_END_DATE'] != '') {
	$NOTES_FOLLOWUP_END_DATE = date("Y-m-d", strtotime($_REQUEST['NOTES_FOLLOWUP_END_DATE']));

	$cond .= " AND S_STUDENT_NOTES.NOTE_DATE <= '$NOTES_FOLLOWUP_END_DATE' ";
}

if ($_REQUEST['NOTE_STATUS'] != '')
	$cond .= " AND S_STUDENT_NOTES.PK_NOTE_STATUS IN ($_REQUEST[NOTE_STATUS]) ";

if ($_REQUEST['NOTE_TYPE'] != '')
	$cond .= " AND S_STUDENT_NOTES.PK_NOTE_TYPE IN ($_REQUEST[NOTE_TYPE]) ";

if ($_REQUEST['PROBATION_BEGIN_DATE'] != '' || $_REQUEST['PROBATION_END_DATE'] != '' || $_REQUEST['PROBATION_LEVEL'] != '' || $_REQUEST['PROBATION_STATUS'] != '' || $_REQUEST['PROBATION_TYPE'] != '') {
	$table .= ", S_STUDENT_PROBATION";
	$cond .= " AND S_STUDENT_PROBATION.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}

if ($_REQUEST['PROBATION_BEGIN_DATE'] != '' && $_REQUEST['PROBATION_END_DATE'] != '') {
	$PROBATION_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['PROBATION_BEGIN_DATE']));
	$PROBATION_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['PROBATION_END_DATE']));

	$cond .= " AND S_STUDENT_PROBATION.BEGIN_DATE BETWEEN '$PROBATION_BEGIN_DATE' AND '$PROBATION_END_DATE' ";
} else if ($_REQUEST['PROBATION_BEGIN_DATE'] != '') {
	$PROBATION_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['PROBATION_BEGIN_DATE']));

	$cond .= " AND S_STUDENT_PROBATION.BEGIN_DATE >= '$PROBATION_BEGIN_DATE' ";
} else if ($_REQUEST['PROBATION_END_DATE'] != '') {
	$PROBATION_END_DATE = date("Y-m-d", strtotime($_REQUEST['PROBATION_END_DATE']));

	$cond .= " AND S_STUDENT_PROBATION.BEGIN_DATE <= '$PROBATION_END_DATE' ";
}

if ($_REQUEST['PROBATION_LEVEL'] != '')
	$cond .= " AND S_STUDENT_PROBATION.PK_PROBATION_LEVEL IN ($_REQUEST[PROBATION_LEVEL]) ";

if ($_REQUEST['PROBATION_STATUS'] != '')
	$cond .= " AND S_STUDENT_PROBATION.PK_PROBATION_STATUS IN ($_REQUEST[PROBATION_STATUS]) ";

if ($_REQUEST['PROBATION_TYPE'] != '')
	$cond .= " AND S_STUDENT_PROBATION.PK_PROBATION_TYPE IN ($_REQUEST[PROBATION_TYPE]) ";

if ($_REQUEST['TASK_ATTACHMENT'] != '' || $_REQUEST['TASK_COMPLETED'] != '' || $_REQUEST['TASK_BEGIN_DATE'] != '' || $_REQUEST['TASK_END_DATE'] != '' || $_REQUEST['TASK_EMPLOYEE'] != '' || $_REQUEST['TASK_FOLLOWUP_BEGIN_DATE'] != '' || $_REQUEST['TASK_FOLLOWUP_END_DATE'] != '' || $_REQUEST['TASK_OTHER'] != '' || $_REQUEST['TASK_PRIORITY'] != '' || $_REQUEST['TASK_STATUS'] != '' || $_REQUEST['TASK_TYPE'] != '') {
	$table .= ", S_STUDENT_TASK ";
	$cond .= " AND S_STUDENT_TASK.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}

if ($_REQUEST['TASK_ATTACHMENT'] == 1) {
	$table .= ", S_STUDENT_TASK_DOCUMENTS ";
	$cond .= " AND S_STUDENT_TASK.PK_STUDENT_TASK = S_STUDENT_TASK_DOCUMENTS.PK_STUDENT_TASK ";
}

if ($_REQUEST['TASK_COMPLETED'] == 1)
	$cond .= " AND S_STUDENT_TASK.COMPLETED = 1 ";
else if ($_REQUEST['TASK_COMPLETED'] == 2)
	$cond .= " AND S_STUDENT_TASK.COMPLETED = 0 ";

if ($_REQUEST['TASK_BEGIN_DATE'] != '' && $_REQUEST['TASK_END_DATE'] != '') {
	$TASK_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['TASK_BEGIN_DATE']));
	$TASK_END_DATE 		= date("Y-m-d", strtotime($_REQUEST['TASK_END_DATE']));

	$cond .= " AND S_STUDENT_TASK.TASK_DATE BETWEEN '$TASK_BEGIN_DATE' AND '$TASK_END_DATE' ";
} else if ($_REQUEST['TASK_BEGIN_DATE'] != '') {
	$TASK_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['TASK_BEGIN_DATE']));

	$cond .= " AND S_STUDENT_TASK.TASK_DATE >= '$TASK_BEGIN_DATE' ";
} else if ($_REQUEST['TASK_END_DATE'] != '') {
	$TASK_END_DATE = date("Y-m-d", strtotime($_REQUEST['TASK_END_DATE']));

	$cond .= " AND S_STUDENT_TASK.TASK_DATE <= '$TASK_END_DATE' ";
}

if ($_REQUEST['TASK_EMPLOYEE'] != '')
	$cond .= " AND S_STUDENT_TASK.PK_EMPLOYEE_MASTER IN ($_REQUEST[TASK_EMPLOYEE]) ";

if ($_REQUEST['TASK_FOLLOWUP_BEGIN_DATE'] != '' && $_REQUEST['TASK_FOLLOWUP_END_DATE'] != '') {
	$TASK_FOLLOWUP_BEGIN_DATE 	= date("Y-m-d", strtotime($_REQUEST['TASK_FOLLOWUP_BEGIN_DATE']));
	$TASK_FOLLOWUP_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['TASK_FOLLOWUP_END_DATE']));

	$cond .= " AND S_STUDENT_TASK.FOLLOWUP_DATE BETWEEN '$TASK_FOLLOWUP_BEGIN_DATE' AND '$TASK_FOLLOWUP_END_DATE' ";
} else if ($_REQUEST['TASK_FOLLOWUP_BEGIN_DATE'] != '') {
	$TASK_FOLLOWUP_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['TASK_FOLLOWUP_BEGIN_DATE']));

	$cond .= " AND S_STUDENT_TASK.FOLLOWUP_DATE >= '$TASK_FOLLOWUP_BEGIN_DATE' ";
} else if ($_REQUEST['TASK_FOLLOWUP_END_DATE'] != '') {
	$TASK_FOLLOWUP_END_DATE = date("Y-m-d", strtotime($_REQUEST['TASK_FOLLOWUP_END_DATE']));

	$cond .= " AND S_STUDENT_TASK.FOLLOWUP_DATE <= '$TASK_FOLLOWUP_END_DATE' ";
}

if ($_REQUEST['TASK_OTHER'] != '')
	$cond .= " AND S_STUDENT_TASK.PK_EVENT_OTHER IN ($_REQUEST[TASK_OTHER]) ";

if ($_REQUEST['TASK_PRIORITY'] != '')
	$cond .= " AND S_STUDENT_TASK.PK_NOTES_PRIORITY_MASTER IN ($_REQUEST[TASK_PRIORITY]) ";

if ($_REQUEST['TASK_STATUS'] != '')
	$cond .= " AND S_STUDENT_TASK.PK_TASK_STATUS IN ($_REQUEST[TASK_STATUS]) ";

if ($_REQUEST['TASK_TYPE'] != '')
	$cond .= " AND S_STUDENT_TASK.PK_TASK_TYPE IN ($_REQUEST[TASK_TYPE]) ";

if ($_REQUEST['TEXT_CELL_NUMBER'] != '' || $_REQUEST['TEXT_BEGIN_DATE'] != '' || $_REQUEST['TEXT_END_DATE'] != '' || $_REQUEST['TEXT_DEPARTMENT'] != '' || $_REQUEST['TEXT_EMPLOYEE'] != '' || $_REQUEST['TEXT_STATUS'] != '') {
	$table .= ", S_TEXT_LOG ";
	$cond .= " AND S_TEXT_LOG.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}

if ($_REQUEST['TEXT_CELL_NUMBER'] != '') {
	$CELL_NUMBER	= preg_replace('/[^0-9]/', '', $_REQUEST['TEXT_CELL_NUMBER']);
	$cond .= " AND REPLACE(REPLACE(REPLACE(REPLACE(S_TEXT_LOG.TO_PHONE, '(', ''), ')', ''), '-', ''),' ','') = '$CELL_NUMBER' ";
}

if ($_REQUEST['TEXT_BEGIN_DATE'] != '' && $_REQUEST['TEXT_END_DATE'] != '') {
	$TEXT_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['TEXT_BEGIN_DATE']));
	$TEXT_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['TEXT_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_TEXT_LOG.SENT_ON, '%Y-%m-%d') BETWEEN '$TEXT_BEGIN_DATE' AND '$TEXT_END_DATE' ";
} else if ($_REQUEST['TEXT_BEGIN_DATE'] != '') {
	$TEXT_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['TEXT_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_TEXT_LOG.SENT_ON, '%Y-%m-%d') >= '$TEXT_BEGIN_DATE' ";
} else if ($_REQUEST['TEXT_END_DATE'] != '') {
	$TEXT_END_DATE = date("Y-m-d", strtotime($_REQUEST['TEXT_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_TEXT_LOG.SENT_ON, '%Y-%m-%d') <= '$TEXT_END_DATE' ";
}

if ($_REQUEST['TEXT_DEPARTMENT'] != '')
	$cond .= " AND S_TEXT_LOG.PK_DEPARTMENT IN ($_REQUEST[TEXT_DEPARTMENT]) ";

if ($_REQUEST['TEXT_EMPLOYEE'] != '')
	$cond .= " AND S_TEXT_LOG.PK_EMPLOYEE_MASTER IN ($_REQUEST[TEXT_EMPLOYEE]) ";

if ($_REQUEST['TEXT_STATUS'] == 1)
	$cond .= " AND S_TEXT_LOG.IS_RECEIVED_MSG = 1 ";
else if ($_REQUEST['TEXT_STATUS'] == 2)
	$cond .= " AND S_TEXT_LOG.IS_RECEIVED_MSG = 0 ";

if ($_REQUEST['DOC_DATE_RECEIVED_BEGIN_DATE'] != '' || $_REQUEST['DOC_DATE_RECEIVED_END_DATE'] != '' || $_REQUEST['DOC_DEPARTMENT'] != '' || $_REQUEST['DOC_EMPLOYEE'] != '' || $_REQUEST['DOC_DATE_FOLLOWUP_BEGIN_DATE'] != '' || $_REQUEST['DOC_DATE_FOLLOWUP_END_DATE'] != '' || $_REQUEST['DOC_NAME'] != '' || $_REQUEST['DOC_RECEIVED'] != '' || $_REQUEST['DOC_DATE_REQUESTED_BEGIN_DATE'] != '' || $_REQUEST['DOC_DATE_REQUESTED_END_DATE'] != '') {
	$table .= ", S_STUDENT_DOCUMENTS ";
	$cond .= " AND S_STUDENT_DOCUMENTS.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}

if ($_REQUEST['DOC_DATE_RECEIVED_BEGIN_DATE'] != '' && $_REQUEST['DOC_DATE_RECEIVED_END_DATE'] != '') {
	$DOC_DATE_RECEIVED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_RECEIVED_BEGIN_DATE']));
	$DOC_DATE_RECEIVED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DOC_DATE_RECEIVED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.DATE_RECEIVED, '%Y-%m-%d') BETWEEN '$DOC_DATE_RECEIVED_BEGIN_DATE' AND '$DOC_DATE_RECEIVED_END_DATE' ";
} else if ($_REQUEST['DOC_DATE_RECEIVED_BEGIN_DATE'] != '') {
	$DOC_DATE_RECEIVED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_RECEIVED_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.DATE_RECEIVED, '%Y-%m-%d') >= '$DOC_DATE_RECEIVED_BEGIN_DATE' ";
} else if ($_REQUEST['DOC_DATE_RECEIVED_END_DATE'] != '') {
	$DOC_DATE_RECEIVED_END_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_RECEIVED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.DATE_RECEIVED, '%Y-%m-%d') <= '$DOC_DATE_RECEIVED_END_DATE' ";
}

if ($_REQUEST['DOC_EMPLOYEE'] != '')
	$cond .= " AND S_STUDENT_DOCUMENTS.PK_EMPLOYEE_MASTER IN ($_REQUEST[DOC_EMPLOYEE]) ";

if ($_REQUEST['DOC_DEPARTMENT'] != '') {
	$table .= ", S_STUDENT_DOCUMENTS_DEPARTMENT ";
	$cond .= " AND S_STUDENT_DOCUMENTS_DEPARTMENT.PK_STUDENT_DOCUMENTS = S_STUDENT_DOCUMENTS.PK_STUDENT_DOCUMENTS AND S_STUDENT_DOCUMENTS_DEPARTMENT.PK_DEPARTMENT IN ($_REQUEST[DOC_DEPARTMENT]) ";
}

if ($_REQUEST['DOC_DATE_FOLLOWUP_BEGIN_DATE'] != '' && $_REQUEST['DOC_DATE_FOLLOWUP_END_DATE'] != '') {
	$DOC_DATE_FOLLOWUP_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_FOLLOWUP_BEGIN_DATE']));
	$DOC_DATE_FOLLOWUP_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DOC_DATE_FOLLOWUP_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.FOLLOWUP_DATE, '%Y-%m-%d') BETWEEN '$DOC_DATE_FOLLOWUP_BEGIN_DATE' AND '$DOC_DATE_FOLLOWUP_END_DATE' ";
} else if ($_REQUEST['DOC_DATE_FOLLOWUP_BEGIN_DATE'] != '') {
	$DOC_DATE_FOLLOWUP_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_FOLLOWUP_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.FOLLOWUP_DATE, '%Y-%m-%d') >= '$DOC_DATE_FOLLOWUP_BEGIN_DATE' ";
} else if ($_REQUEST['DOC_DATE_FOLLOWUP_END_DATE'] != '') {
	$DOC_DATE_FOLLOWUP_END_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_FOLLOWUP_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.FOLLOWUP_DATE, '%Y-%m-%d') <= '$DOC_DATE_FOLLOWUP_END_DATE' ";
}

if ($_REQUEST['DOC_NAME'] != '') {
	$DOC_DEPARTMENT = trim($_REQUEST['DOC_NAME']);
	$table .= ", M_DOCUMENT_TYPE ";
	$cond .= " AND M_DOCUMENT_TYPE.PK_DOCUMENT_TYPE = S_STUDENT_DOCUMENTS.PK_DOCUMENT_TYPE AND (trim(S_STUDENT_DOCUMENTS.DOCUMENT_TYPE) = '$DOC_DEPARTMENT' or trim(M_DOCUMENT_TYPE.DOCUMENT_TYPE) = '$DOC_DEPARTMENT') ";
}

if ($_REQUEST['DOC_RECEIVED'] == 1)
	$cond .= " AND S_STUDENT_DOCUMENTS.RECEIVED = 1 ";
else if ($_REQUEST['DOC_RECEIVED'] == 2)
	$cond .= " AND S_STUDENT_DOCUMENTS.RECEIVED = 0 ";

if ($_REQUEST['DOC_DATE_REQUESTED_BEGIN_DATE'] != '' && $_REQUEST['DOC_DATE_REQUESTED_END_DATE'] != '') {
	$DOC_DATE_REQUESTED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_REQUESTED_BEGIN_DATE']));
	$DOC_DATE_REQUESTED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DOC_DATE_REQUESTED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.REQUESTED_DATE, '%Y-%m-%d') BETWEEN '$DOC_DATE_REQUESTED_BEGIN_DATE' AND '$DOC_DATE_REQUESTED_END_DATE' ";
} else if ($_REQUEST['DOC_DATE_REQUESTED_BEGIN_DATE'] != '') {
	$DOC_DATE_REQUESTED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_REQUESTED_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.REQUESTED_DATE, '%Y-%m-%d') >= '$DOC_DATE_REQUESTED_BEGIN_DATE' ";
} else if ($_REQUEST['DOC_DATE_REQUESTED_END_DATE'] != '') {
	$DOC_DATE_REQUESTED_END_DATE = date("Y-m-d", strtotime($_REQUEST['DOC_DATE_REQUESTED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DOCUMENTS.REQUESTED_DATE, '%Y-%m-%d') <= '$DOC_DATE_REQUESTED_END_DATE' ";
}

if ($_REQUEST['REQUIREMENT'] != '' || $_REQUEST['REQUIREMENT_CATEGORY'] != '' || $_REQUEST['REQUIREMENT_COMPLETED'] != '' || $_REQUEST['REQUIREMENT_COMPLETED_ON_BEGIN_DATE'] != '' || $_REQUEST['REQUIREMENT_COMPLETED_ON_END_DATE'] != '' || $_REQUEST['REQUIREMENT_TYPE'] != '') {
	$table .= ", S_STUDENT_REQUIREMENT ";
	$cond .= " AND S_STUDENT_REQUIREMENT.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}
if ($_REQUEST['REQUIREMENT'] != '') {
	$REQUIREMENT = trim($_REQUEST['REQUIREMENT']);
	$cond .= " AND trim(S_STUDENT_REQUIREMENT.REQUIREMENT) = '$REQUIREMENT'  ";
}

if ($_REQUEST['REQUIREMENT_CATEGORY'] != '')
	$cond .= " AND S_STUDENT_REQUIREMENT.PK_REQUIREMENT_CATEGORY IN ($_REQUEST[REQUIREMENT_CATEGORY]) ";

if ($_REQUEST['REQUIREMENT_COMPLETED'] == 1)
	$cond .= " AND S_STUDENT_REQUIREMENT.COMPLETED = 1 ";
else if ($_REQUEST['REQUIREMENT_COMPLETED'] == 2)
	$cond .= " AND S_STUDENT_REQUIREMENT.COMPLETED = 0 ";

if ($_REQUEST['REQUIREMENT_COMPLETED_ON_BEGIN_DATE'] != '' && $_REQUEST['REQUIREMENT_COMPLETED_ON_END_DATE'] != '') {
	$REQUIREMENT_COMPLETED_ON_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['REQUIREMENT_COMPLETED_ON_BEGIN_DATE']));
	$REQUIREMENT_COMPLETED_ON_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['REQUIREMENT_COMPLETED_ON_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_REQUIREMENT.COMPLETED_ON, '%Y-%m-%d') BETWEEN '$REQUIREMENT_COMPLETED_ON_BEGIN_DATE' AND '$REQUIREMENT_COMPLETED_ON_END_DATE' ";
} else if ($_REQUEST['REQUIREMENT_COMPLETED_ON_BEGIN_DATE'] != '') {
	$REQUIREMENT_COMPLETED_ON_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['REQUIREMENT_COMPLETED_ON_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_REQUIREMENT.COMPLETED_ON, '%Y-%m-%d') >= '$REQUIREMENT_COMPLETED_ON_BEGIN_DATE' ";
} else if ($_REQUEST['REQUIREMENT_COMPLETED_ON_END_DATE'] != '') {
	$REQUIREMENT_COMPLETED_ON_END_DATE = date("Y-m-d", strtotime($_REQUEST['REQUIREMENT_COMPLETED_ON_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_REQUIREMENT.COMPLETED_ON, '%Y-%m-%d') <= '$REQUIREMENT_COMPLETED_ON_END_DATE' ";
}

if ($_REQUEST['REQUIREMENT_TYPE'] == 1)
	$cond .= " AND S_STUDENT_REQUIREMENT.TYPE = 1 ";
else if ($_REQUEST['REQUIREMENT_TYPE'] == 2)
	$cond .= " AND S_STUDENT_REQUIREMENT.TYPE = 2 ";

if ($_REQUEST['OTHER_EDU_EDU_TYPE'] != '' || $_REQUEST['OTHER_EDU_GRADUATED'] != '' || $_REQUEST['OTHER_EDU_GRADUATED_BEGIN_DATE'] != '' || $_REQUEST['OTHER_EDU_GRADUATED_END_DATE'] != '' || $_REQUEST['OTHER_EDU_SCHOOL_CITY'] != '' || $_REQUEST['OTHER_EDU_SCHOOL_FAX'] != '' || $_REQUEST['OTHER_EDU_SCHOOL_NAME'] != '' || $_REQUEST['OTHER_EDU_SCHOOL_PHONE'] != '' || $_REQUEST['OTHER_EDU_SCHOOL_STATE'] != '' || $_REQUEST['OTHER_EDU_SCHOOL_ZIP'] != '' || $_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED'] != '' || $_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE'] != '' || $_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE'] != '' || $_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED'] != '' || $_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE'] != '' || $_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE'] != '') {
	$table .= ", S_STUDENT_OTHER_EDU ";
	$cond .= " AND S_STUDENT_OTHER_EDU.PK_STUDENT_MASTER = S_STUDENT_MASTER.PK_STUDENT_MASTER ";
}

if ($_REQUEST['OTHER_EDU_EDU_TYPE'] != '')
	$cond .= " AND S_STUDENT_OTHER_EDU.PK_EDUCATION_TYPE IN ($_REQUEST[OTHER_EDU_EDU_TYPE]) ";

if ($_REQUEST['OTHER_EDU_GRADUATED'] == 1)
	$cond .= " AND S_STUDENT_OTHER_EDU.GRADUATED = 1 ";
else if ($_REQUEST['OTHER_EDU_GRADUATED'] == 2)
	$cond .= " AND S_STUDENT_OTHER_EDU.GRADUATED = 0 ";

if ($_REQUEST['OTHER_EDU_GRADUATED_BEGIN_DATE'] != '' && $_REQUEST['OTHER_EDU_GRADUATED_END_DATE'] != '') {
	$OTHER_EDU_GRADUATED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_GRADUATED_BEGIN_DATE']));
	$OTHER_EDU_GRADUATED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_GRADUATED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.GRADUATED_DATE, '%Y-%m-%d') BETWEEN '$OTHER_EDU_GRADUATED_BEGIN_DATE' AND '$OTHER_EDU_GRADUATED_END_DATE' ";
} else if ($_REQUEST['OTHER_EDU_GRADUATED_BEGIN_DATE'] != '') {
	$OTHER_EDU_GRADUATED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_GRADUATED_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.GRADUATED_DATE, '%Y-%m-%d') >= '$OTHER_EDU_GRADUATED_BEGIN_DATE' ";
} else if ($_REQUEST['OTHER_EDU_GRADUATED_END_DATE'] != '') {
	$OTHER_EDU_GRADUATED_END_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_GRADUATED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.GRADUATED_DATE, '%Y-%m-%d') <= '$OTHER_EDU_GRADUATED_END_DATE' ";
}

if ($_REQUEST['OTHER_EDU_SCHOOL_CITY'] != '') {
	$OTHER_EDU_SCHOOL_CITY	= trim($_REQUEST['OTHER_EDU_SCHOOL_CITY']);
	$cond .= " AND trim(S_STUDENT_OTHER_EDU.CITY) = '$OTHER_EDU_SCHOOL_CITY' ";
}

if ($_REQUEST['OTHER_EDU_SCHOOL_FAX'] != '') {
	$OTHER_EDU_SCHOOL_FAX	= preg_replace('/[^0-9]/', '', $_REQUEST['OTHER_EDU_SCHOOL_FAX']);
	$cond .= " AND REPLACE(REPLACE(REPLACE(REPLACE(S_STUDENT_OTHER_EDU.OTHER_SCHOOL_FAX, '(', ''), ')', ''), '-', ''),' ','') = '$OTHER_EDU_SCHOOL_FAX' ";
}

if ($_REQUEST['OTHER_EDU_SCHOOL_NAME'] != '') {
	$OTHER_EDU_SCHOOL_NAME	= trim($_REQUEST['OTHER_EDU_SCHOOL_NAME']);
	$cond .= " AND trim(S_STUDENT_OTHER_EDU.SCHOOL_NAME) = '$OTHER_EDU_SCHOOL_NAME' ";
}

if ($_REQUEST['OTHER_EDU_SCHOOL_PHONE'] != '') {
	$OTHER_EDU_SCHOOL_PHONE	= preg_replace('/[^0-9]/', '', $_REQUEST['OTHER_EDU_SCHOOL_PHONE']);
	$cond .= " AND REPLACE(REPLACE(REPLACE(REPLACE(S_STUDENT_OTHER_EDU.OTHER_SCHOOL_PHONE, '(', ''), ')', ''), '-', ''),' ','') = '$OTHER_EDU_SCHOOL_PHONE' ";
}

if ($_REQUEST['OTHER_EDU_SCHOOL_STATE'] != '')
	$cond .= " AND S_STUDENT_OTHER_EDU.PK_STATE IN ($_REQUEST[OTHER_EDU_SCHOOL_STATE]) ";

if ($_REQUEST['OTHER_EDU_SCHOOL_ZIP'] != '') {
	$OTHER_EDU_SCHOOL_ZIP	= trim($_REQUEST['OTHER_EDU_SCHOOL_ZIP']);
	$cond .= " AND trim(S_STUDENT_OTHER_EDU.SCHOOL_NAME) = '$OTHER_EDU_SCHOOL_ZIP' ";
}

if ($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED'] == 1)
	$cond .= " AND S_STUDENT_OTHER_EDU.TRANSCRIPT_RECEIVED = 1 ";
else if ($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED'] == 2)
	$cond .= " AND S_STUDENT_OTHER_EDU.TRANSCRIPT_RECEIVED = 0 ";

if ($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE'] != '' && $_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE'] != '') {
	$OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE']));
	$OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.TRANSCRIPT_RECEIVED_DATE, '%Y-%m-%d') BETWEEN '$OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE' AND '$OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE' ";
} else if ($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE'] != '') {
	$OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.TRANSCRIPT_RECEIVED_DATE, '%Y-%m-%d') >= '$OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE' ";
} else if ($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE'] != '') {
	$OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.TRANSCRIPT_RECEIVED_DATE, '%Y-%m-%d') <= '$OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE' ";
}

if ($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED'] == 1)
	$cond .= " AND S_STUDENT_OTHER_EDU.TRANSCRIPT_REQUESTED = 1 ";
else if ($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED'] == 2)
	$cond .= " AND S_STUDENT_OTHER_EDU.TRANSCRIPT_REQUESTED = 0 ";

if ($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE'] != '' && $_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE'] != '') {
	$OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE']));
	$OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.TRANSCRIPT_REQUESTED_DATE, '%Y-%m-%d') BETWEEN '$OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE' AND '$OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE' ";
} else if ($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE'] != '') {
	$OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.TRANSCRIPT_REQUESTED_DATE, '%Y-%m-%d') >= '$OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE' ";
} else if ($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE'] != '') {
	$OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE = date("Y-m-d", strtotime($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_OTHER_EDU.TRANSCRIPT_REQUESTED_DATE, '%Y-%m-%d') <= '$OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE' ";
}

if ($_REQUEST['DISBURSEMENT_AP'] != '' || $_REQUEST['DISBURSEMENT_APPROVED_BEGIN_DATE'] != '' || $_REQUEST['DISBURSEMENT_APPROVED_END_DATE'] != '' || $_REQUEST['DISBURSEMENT_AWARD_YEAR'] != '' || $_REQUEST['DISBURSEMENT_AY'] != '' || $_REQUEST['DISBURSEMENT_BATCH'] != '' || $_REQUEST['DISBURSEMENT_DEPOSITED_BEGIN_DATE'] != '' || $_REQUEST['DISBURSEMENT_DEPOSITED_END_DATE'] != '' || $_REQUEST['DISBURSEMENT_AMOUNT_FROM'] != '' || $_REQUEST['DISBURSEMENT_AMOUNT_TO'] != '' || $_REQUEST['DISBURSEMENT_BEGIN_DATE'] != '' || $_REQUEST['DISBURSEMENT_END_DATE'] != '' || $_REQUEST['DISBURSEMENT_FUND_REQUESTED'] != '' || $_REQUEST['DISBURSEMENT_HOURS_REQUIRED'] != '' || $_REQUEST['DISBURSEMENT_LEDGER_CODE'] != '' || $_REQUEST['DISBURSEMENT_STATUS'] != '') {
	$table .= ", S_STUDENT_DISBURSEMENT ";
	$cond .= " AND S_STUDENT_DISBURSEMENT.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}

if ($_REQUEST['DISBURSEMENT_AP'] != '')
	$cond .= " AND S_STUDENT_DISBURSEMENT.ACADEMIC_YEAR = '$_REQUEST[DISBURSEMENT_AP]' ";

if ($_REQUEST['DISBURSEMENT_APPROVED_BEGIN_DATE'] != '' && $_REQUEST['DISBURSEMENT_APPROVED_END_DATE'] != '') {
	$DISBURSEMENT_APPROVED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_APPROVED_BEGIN_DATE']));
	$DISBURSEMENT_APPROVED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_APPROVED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.APPROVED_DATE, '%Y-%m-%d') BETWEEN '$DISBURSEMENT_APPROVED_BEGIN_DATE' AND '$DISBURSEMENT_APPROVED_END_DATE' ";
} else if ($_REQUEST['DISBURSEMENT_APPROVED_BEGIN_DATE'] != '') {
	$DISBURSEMENT_APPROVED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_APPROVED_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.APPROVED_DATE, '%Y-%m-%d') >= '$DISBURSEMENT_APPROVED_BEGIN_DATE' ";
} else if ($_REQUEST['DISBURSEMENT_APPROVED_END_DATE'] != '') {
	$DISBURSEMENT_APPROVED_END_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_APPROVED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.APPROVED_DATE, '%Y-%m-%d') <= '$DISBURSEMENT_APPROVED_END_DATE' ";
}

if ($_REQUEST['DISBURSEMENT_AWARD_YEAR'] != '')
	$cond .= " AND S_STUDENT_DISBURSEMENT.PK_AWARD_YEAR IN ($_REQUEST[DISBURSEMENT_AWARD_YEAR]) ";

if ($_REQUEST['DISBURSEMENT_AY'] != '')
	$cond .= " AND S_STUDENT_DISBURSEMENT.ACADEMIC_YEAR = '$_REQUEST[DISBURSEMENT_AY]' ";

if ($_REQUEST['DISBURSEMENT_DEPOSITED_BEGIN_DATE'] != '' && $_REQUEST['DISBURSEMENT_DEPOSITED_END_DATE'] != '') {
	$DISBURSEMENT_DEPOSITED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_DEPOSITED_BEGIN_DATE']));
	$DISBURSEMENT_DEPOSITED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_DEPOSITED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.DEPOSITED_DATE, '%Y-%m-%d') BETWEEN '$DISBURSEMENT_DEPOSITED_BEGIN_DATE' AND '$DISBURSEMENT_DEPOSITED_END_DATE' ";
} else if ($_REQUEST['DISBURSEMENT_DEPOSITED_BEGIN_DATE'] != '') {
	$DISBURSEMENT_DEPOSITED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_DEPOSITED_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.DEPOSITED_DATE, '%Y-%m-%d') >= '$DISBURSEMENT_DEPOSITED_BEGIN_DATE' ";
} else if ($_REQUEST['DISBURSEMENT_DEPOSITED_END_DATE'] != '') {
	$DISBURSEMENT_DEPOSITED_END_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_DEPOSITED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.DEPOSITED_DATE, '%Y-%m-%d') <= '$DISBURSEMENT_DEPOSITED_END_DATE' ";
}

if ($_REQUEST['DISBURSEMENT_AMOUNT_FROM'] != '' && $_REQUEST['DISBURSEMENT_AMOUNT_TO'] != '') {
	$cond .= " AND S_STUDENT_DISBURSEMENT.DISBURSEMENT_AMOUNT BETWEEN $_REQUEST[DISBURSEMENT_AMOUNT_FROM] AND $_REQUEST[DISBURSEMENT_AMOUNT_TO] ";
} else if ($_REQUEST['DISBURSEMENT_AMOUNT_FROM'] != '') {
	$cond .= " AND S_STUDENT_DISBURSEMENT.DISBURSEMENT_AMOUNT >= $_REQUEST[DISBURSEMENT_AMOUNT_FROM] ";
} else if ($_REQUEST['DISBURSEMENT_AMOUNT_TO'] != '') {
	$cond .= " AND S_STUDENT_DISBURSEMENT.DISBURSEMENT_AMOUNT <= $_REQUEST[DISBURSEMENT_AMOUNT_TO] ";
}

if ($_REQUEST['DISBURSEMENT_BEGIN_DATE'] != '' && $_REQUEST['DISBURSEMENT_END_DATE'] != '') {
	$DISBURSEMENT_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_BEGIN_DATE']));
	$DISBURSEMENT_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.DISBURSEMENT_DATE, '%Y-%m-%d') BETWEEN '$DISBURSEMENT_BEGIN_DATE' AND '$DISBURSEMENT_END_DATE' ";
} else if ($_REQUEST['DISBURSEMENT_BEGIN_DATE'] != '') {
	$DISBURSEMENT_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.DISBURSEMENT_DATE, '%Y-%m-%d') >= '$DISBURSEMENT_BEGIN_DATE' ";
} else if ($_REQUEST['DISBURSEMENT_END_DATE'] != '') {
	$DISBURSEMENT_END_DATE = date("Y-m-d", strtotime($_REQUEST['DISBURSEMENT_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_DISBURSEMENT.DISBURSEMENT_DATE, '%Y-%m-%d') <= '$DISBURSEMENT_END_DATE' ";
}

if ($_REQUEST['DISBURSEMENT_FUND_REQUESTED'] == 1)
	$cond .= " AND S_STUDENT_DISBURSEMENT.FUNDS_REQUESTED = 1 ";
else if ($_REQUEST['OTHER_EDU_TRANSCRIPT_REQUESTED'] == 2)
	$cond .= " AND S_STUDENT_DISBURSEMENT.FUNDS_REQUESTED = 0 ";

if ($_REQUEST['DISBURSEMENT_HOURS_REQUIRED'] != '')
	$cond .= " AND S_STUDENT_DISBURSEMENT.HOURS_REQUIRED = '$_REQUEST[DISBURSEMENT_HOURS_REQUIRED]' ";

if ($_REQUEST['DISBURSEMENT_LEDGER_CODE'] != '')
	$cond .= " AND S_STUDENT_DISBURSEMENT.PK_AR_LEDGER_CODE IN ($_REQUEST[DISBURSEMENT_LEDGER_CODE]) ";

if ($_REQUEST['DISBURSEMENT_STATUS'] != '')
	$cond .= " AND S_STUDENT_DISBURSEMENT.PK_DISBURSEMENT_STATUS IN ($_REQUEST[DISBURSEMENT_STATUS]) ";

////////////////////////////////////////
if ($_REQUEST['ESTIMATED_FEES_AP'] != '' || $_REQUEST['ESTIMATED_FEES_APPROVED_BEGIN_DATE'] != '' || $_REQUEST['ESTIMATED_FEES_APPROVED_END_DATE'] != '' || $_REQUEST['ESTIMATED_FEES_AY'] != '' || $_REQUEST['ESTIMATED_FEES_BATCH'] != '' || $_REQUEST['ESTIMATED_FEES_BEGIN_DATE'] != '' || $_REQUEST['ESTIMATED_FEES_END_DATE'] != '' || $_REQUEST['ESTIMATED_FEES_FROM_AMOUNT'] != '' || $_REQUEST['ESTIMATED_FEES_TO_AMOUNT'] != '' || $_REQUEST['ESTIMATED_FEES_FEE_TYPE'] != '' || $_REQUEST['ESTIMATED_FEES_LEDGER_CODE'] != '' || $_REQUEST['ESTIMATED_FEES_FEE_STATUS'] != '' || $_REQUEST['ESTIMATED_FEES_TRANS_BEGIN_DATE'] != '' || $_REQUEST['ESTIMATED_FEES_TRANS_END_DATE'] != '') {
	$table .= ", S_STUDENT_FEE_BUDGET ";
	$cond .= " AND S_STUDENT_FEE_BUDGET.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}

if ($_REQUEST['ESTIMATED_FEES_AP'] != '')
	$cond .= " AND S_STUDENT_FEE_BUDGET.ACADEMIC_YEAR = '$_REQUEST[ESTIMATED_FEES_AP]' ";

if ($_REQUEST['ESTIMATED_FEES_APPROVED_BEGIN_DATE'] != '' && $_REQUEST['ESTIMATED_FEES_APPROVED_END_DATE'] != '') {
	$ESTIMATED_FEES_APPROVED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_APPROVED_BEGIN_DATE']));
	$ESTIMATED_FEES_APPROVED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_APPROVED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_APPROVED_DATE, '%Y-%m-%d') BETWEEN '$ESTIMATED_FEES_APPROVED_BEGIN_DATE' AND '$ESTIMATED_FEES_APPROVED_END_DATE' ";
} else if ($_REQUEST['ESTIMATED_FEES_APPROVED_BEGIN_DATE'] != '') {
	$ESTIMATED_FEES_APPROVED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_APPROVED_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_APPROVED_DATE, '%Y-%m-%d') >= '$ESTIMATED_FEES_APPROVED_BEGIN_DATE' ";
} else if ($_REQUEST['ESTIMATED_FEES_APPROVED_END_DATE'] != '') {
	$ESTIMATED_FEES_APPROVED_END_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_APPROVED_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_APPROVED_DATE, '%Y-%m-%d') <= '$ESTIMATED_FEES_APPROVED_END_DATE' ";
}

if ($_REQUEST['ESTIMATED_FEES_AY'] != '')
	$cond .= " AND S_STUDENT_FEE_BUDGET.ACADEMIC_PERIOD = '$_REQUEST[ESTIMATED_FEES_AY]' ";

if ($_REQUEST['ESTIMATED_FEES_BATCH'] != '') {
	$table .= ", S_TUITION_BATCH_DETAIL, S_TUITION_BATCH_MASTER ";
	$cond .= " AND S_STUDENT_FEE_BUDGET.PK_TUITION_BATCH_DETAIL = S_TUITION_BATCH_DETAIL.PK_TUITION_BATCH_DETAIL AND S_TUITION_BATCH_MASTER.BATCH_NO = '$_REQUEST[ESTIMATED_FEES_BATCH]' AND S_TUITION_BATCH_MASTER.PK_TUITION_BATCH_MASTER = S_TUITION_BATCH_DETAIL.PK_TUITION_BATCH_MASTER ";
}

if ($_REQUEST['ESTIMATED_FEES_BEGIN_DATE'] != '' && $_REQUEST['ESTIMATED_FEES_END_DATE'] != '') {
	$ESTIMATED_FEES_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_BEGIN_DATE']));
	$ESTIMATED_FEES_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_DATE, '%Y-%m-%d') BETWEEN '$ESTIMATED_FEES_BEGIN_DATE' AND '$ESTIMATED_FEES_END_DATE' ";
} else if ($_REQUEST['ESTIMATED_FEES_BEGIN_DATE'] != '') {
	$ESTIMATED_FEES_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_DATE, '%Y-%m-%d') >= '$ESTIMATED_FEES_BEGIN_DATE' ";
} else if ($_REQUEST['ESTIMATED_FEES_END_DATE'] != '') {
	$ESTIMATED_FEES_END_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_DATE, '%Y-%m-%d') <= '$ESTIMATED_FEES_END_DATE' ";
}

if ($_REQUEST['ESTIMATED_FEES_FROM_AMOUNT'] != '' && $_REQUEST['ESTIMATED_FEES_TO_AMOUNT'] != '') {
	$cond .= " AND S_STUDENT_FEE_BUDGET.FEE_AMOUNT BETWEEN $_REQUEST[ESTIMATED_FEES_FROM_AMOUNT] AND $_REQUEST[ESTIMATED_FEES_TO_AMOUNT] ";
} else if ($_REQUEST['ESTIMATED_FEES_FROM_AMOUNT'] != '') {
	$cond .= " AND S_STUDENT_FEE_BUDGET.FEE_AMOUNT >= $_REQUEST[ESTIMATED_FEES_FROM_AMOUNT] ";
} else if ($_REQUEST['ESTIMATED_FEES_TO_AMOUNT'] != '') {
	$cond .= " AND S_STUDENT_FEE_BUDGET.FEE_AMOUNT <= $_REQUEST[ESTIMATED_FEES_TO_AMOUNT] ";
}

if ($_REQUEST['ESTIMATED_FEES_FEE_TYPE'] != '')
	$cond .= " AND S_STUDENT_FEE_BUDGET.PK_FEE_TYPE IN ($_REQUEST[ESTIMATED_FEES_FEE_TYPE]) ";

if ($_REQUEST['ESTIMATED_FEES_LEDGER_CODE'] != '')
	$cond .= " AND S_STUDENT_FEE_BUDGET.PK_AR_LEDGER_CODE IN ($_REQUEST[ESTIMATED_FEES_LEDGER_CODE]) ";

if ($_REQUEST['ESTIMATED_FEES_FEE_STATUS'] != '')
	$cond .= " AND S_STUDENT_FEE_BUDGET.PK_ESTIMATE_FEE_STATUS IN ($_REQUEST[ESTIMATED_FEES_FEE_STATUS]) ";

if ($_REQUEST['ESTIMATED_FEES_TRANS_BEGIN_DATE'] != '' && $_REQUEST['ESTIMATED_FEES_TRANS_END_DATE'] != '') {
	$ESTIMATED_FEES_TRANS_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_TRANS_BEGIN_DATE']));
	$ESTIMATED_FEES_TRANS_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_TRANS_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_DEPOSITED_DATE, '%Y-%m-%d') BETWEEN '$ESTIMATED_FEES_TRANS_BEGIN_DATE' AND '$ESTIMATED_FEES_TRANS_END_DATE' ";
} else if ($_REQUEST['ESTIMATED_FEES_TRANS_BEGIN_DATE'] != '') {
	$ESTIMATED_FEES_TRANS_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_TRANS_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_DEPOSITED_DATE, '%Y-%m-%d') >= '$ESTIMATED_FEES_TRANS_BEGIN_DATE' ";
} else if ($_REQUEST['ESTIMATED_FEES_TRANS_END_DATE'] != '') {
	$ESTIMATED_FEES_TRANS_END_DATE = date("Y-m-d", strtotime($_REQUEST['ESTIMATED_FEES_TRANS_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_FEE_BUDGET.FEE_BUDGET_DEPOSITED_DATE, '%Y-%m-%d') <= '$ESTIMATED_FEES_TRANS_END_DATE' ";
}

////////////////////////////////////////

// if ($_REQUEST['COMPANY_JOB_FULL_PART_TIME'] != '')
// 	$cond .= " AND S_STUDENT_JOB.PK_FULL_PART_TIME IN ($_REQUEST[COMPANY_JOB_FULL_PART_TIME]) ";

// if ($_REQUEST['COMPANY_JOB_CANCELLED_BEGIN_DATE'] != '' && $_REQUEST['COMPANY_JOB_CANCELLED_END_DATE'] != '') {
// 	$COMPANY_JOB_CANCELLED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_CANCELLED_BEGIN_DATE']));
// 	$COMPANY_JOB_CANCELLED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_CANCELLED_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_CANCELED, '%Y-%m-%d') BETWEEN '$COMPANY_JOB_CANCELLED_BEGIN_DATE' AND '$COMPANY_JOB_CANCELLED_END_DATE' ";
// } else if ($_REQUEST['COMPANY_JOB_CANCELLED_BEGIN_DATE'] != '') {
// 	$COMPANY_JOB_CANCELLED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_CANCELLED_BEGIN_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_CANCELED, '%Y-%m-%d') >= '$COMPANY_JOB_CANCELLED_BEGIN_DATE' ";
// } else if ($_REQUEST['COMPANY_JOB_CANCELLED_END_DATE'] != '') {
// 	$COMPANY_JOB_CANCELLED_END_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_CANCELLED_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_CANCELED, '%Y-%m-%d') <= '$COMPANY_JOB_CANCELLED_END_DATE' ";
// }

// if ($_REQUEST['COMPANY_JOB_FILLED_BEGIN_DATE'] != '' && $_REQUEST['COMPANY_JOB_FILLED_END_DATE'] != '') {
// 	$COMPANY_JOB_FILLED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_FILLED_BEGIN_DATE']));
// 	$COMPANY_JOB_FILLED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_FILLED_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_FILLED, '%Y-%m-%d') BETWEEN '$COMPANY_JOB_FILLED_BEGIN_DATE' AND '$COMPANY_JOB_FILLED_END_DATE' ";
// } else if ($_REQUEST['COMPANY_JOB_FILLED_BEGIN_DATE'] != '') {
// 	$COMPANY_JOB_FILLED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_FILLED_BEGIN_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_FILLED, '%Y-%m-%d') >= '$COMPANY_JOB_FILLED_BEGIN_DATE' ";
// } else if ($_REQUEST['COMPANY_JOB_FILLED_END_DATE'] != '') {
// 	$COMPANY_JOB_FILLED_END_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_FILLED_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_FILLED, '%Y-%m-%d') <= '$COMPANY_JOB_FILLED_END_DATE' ";
// }

// if ($_REQUEST['COMPANY_JOB_NO'] != '')
// 	$cond .= " AND S_STUDENT_JOB.PK_STUDENT_JOB = '$_REQUEST[COMPANY_JOB_NO]' ";

// if ($_REQUEST['COMPANY_JOB_POSTED_DATE_BEGIN_DATE'] != '' && $_REQUEST['COMPANY_JOB_POSTED_DATE_END_DATE'] != '') {
// 	$COMPANY_JOB_POSTED_DATE_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_POSTED_DATE_BEGIN_DATE']));
// 	$COMPANY_JOB_POSTED_DATE_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_POSTED_DATE_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_POSTED, '%Y-%m-%d') BETWEEN '$COMPANY_JOB_POSTED_DATE_BEGIN_DATE' AND '$COMPANY_JOB_POSTED_DATE_END_DATE' ";
// } else if ($_REQUEST['COMPANY_JOB_POSTED_DATE_BEGIN_DATE'] != '') {
// 	$COMPANY_JOB_POSTED_DATE_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_POSTED_DATE_BEGIN_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_POSTED, '%Y-%m-%d') >= '$COMPANY_JOB_POSTED_DATE_BEGIN_DATE' ";
// } else if ($_REQUEST['COMPANY_JOB_POSTED_DATE_END_DATE'] != '') {
// 	$COMPANY_JOB_POSTED_DATE_END_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_JOB_POSTED_DATE_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_JOB.JOB_POSTED, '%Y-%m-%d') <= '$COMPANY_JOB_POSTED_DATE_END_DATE' ";
// }

// if ($_REQUEST['COMPANY_JOB_TITLE'] != '') {
// 	$COMPANY_JOB_TITLE = trim($_REQUEST['COMPANY_JOB_TITLE']);
// 	$cond .= " AND trim(S_STUDENT_JOB.JOB_TITLE) = '$COMPANY_JOB_TITLE' ";
// }

// if ($_REQUEST['COMPANY_JOB_PAY_AMOUNT_FROM'] != '' && $_REQUEST['COMPANY_JOB_PAY_AMOUNT_TO'] != '') {
// 	$cond .= " AND S_STUDENT_JOB.PAY_AMOUNT BETWEEN $_REQUEST[COMPANY_JOB_PAY_AMOUNT_FROM] AND $_REQUEST[COMPANY_JOB_PAY_AMOUNT_TO] ";
// } else if ($_REQUEST['COMPANY_JOB_PAY_AMOUNT_FROM'] != '') {
// 	$cond .= " AND S_STUDENT_JOB.PAY_AMOUNT >= $_REQUEST[COMPANY_JOB_PAY_AMOUNT_FROM] ";
// } else if ($_REQUEST['COMPANY_JOB_PAY_AMOUNT_TO'] != '') {
// 	$cond .= " AND S_STUDENT_JOB.PAY_AMOUNT <= $_REQUEST[COMPANY_JOB_PAY_AMOUNT_TO] ";
// }

// ////////////////////////////////////////
// if ($_REQUEST['COMPANY_CITY'] != '') {
// 	$COMPANY_CITY = trim($_REQUEST['COMPANY_CITY']);
// 	$cond .= " AND trim(S_COMPANY.CITY) = '$COMPANY_CITY' ";
// }

// if ($_REQUEST['COMPANY_NAME'] != '') {
// 	$COMPANY_NAME = trim($_REQUEST['COMPANY_NAME']);
// 	$cond .= " AND trim(S_COMPANY.COMPANY_NAME) = '$COMPANY_NAME' ";
// }

// if ($_REQUEST['COMPANY_SOURCE'] != '')
// 	$cond .= " AND S_COMPANY.PK_COMPANY_SOURCE IN ($_REQUEST[COMPANY_SOURCE]) ";

// if ($_REQUEST['COMPANY_DATE_CREATED_BEGIN_DATE'] != '' && $_REQUEST['COMPANY_DATE_CREATED_END_DATE'] != '') {
// 	$COMPANY_DATE_CREATED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_DATE_CREATED_BEGIN_DATE']));
// 	$COMPANY_DATE_CREATED_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['COMPANY_DATE_CREATED_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY.DATE_CREATED, '%Y-%m-%d') BETWEEN '$COMPANY_DATE_CREATED_BEGIN_DATE' AND '$COMPANY_DATE_CREATED_END_DATE' ";
// } else if ($_REQUEST['COMPANY_DATE_CREATED_BEGIN_DATE'] != '') {
// 	$COMPANY_DATE_CREATED_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_DATE_CREATED_BEGIN_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY.DATE_CREATED, '%Y-%m-%d') >= '$COMPANY_DATE_CREATED_BEGIN_DATE' ";
// } else if ($_REQUEST['COMPANY_DATE_CREATED_END_DATE'] != '') {
// 	$COMPANY_DATE_CREATED_END_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_DATE_CREATED_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY.DATE_CREATED, '%Y-%m-%d') <= '$COMPANY_DATE_CREATED_END_DATE' ";
// }

// if ($_REQUEST['COMPANY_FAX'] != '') {
// 	$COMPANY_FAX	= preg_replace('/[^0-9]/', '', $_REQUEST['COMPANY_FAX']);
// 	$cond .= " AND REPLACE(REPLACE(REPLACE(REPLACE(S_COMPANY.FAX, '(', ''), ')', ''), '-', ''),' ','') = '$COMPANY_FAX' ";
// }

// if ($_REQUEST['COMPANY_MAIN_CONTACT'] != '')
// 	$cond .= " AND S_COMPANY.PK_COMPANY_CONTACT IN ($_REQUEST[COMPANY_MAIN_CONTACT]) ";

// if ($_REQUEST['COMPANY_PHONE'] != '') {
// 	$COMPANY_PHONE	= preg_replace('/[^0-9]/', '', $_REQUEST['COMPANY_PHONE']);
// 	$cond .= " AND REPLACE(REPLACE(REPLACE(REPLACE(S_COMPANY.PHONE, '(', ''), ')', ''), '-', ''),' ','') = '$COMPANY_PHONE' ";
// }

// if ($_REQUEST['COMPANY_SCHOOL_EMPLOYEE'] != '')
// 	$cond .= " AND S_COMPANY.PK_COMPANY_ADVISOR IN ($_REQUEST[COMPANY_SCHOOL_EMPLOYEE]) ";

// if ($_REQUEST['COMPANY_STATUS'] != '')
// 	$cond .= " AND S_COMPANY.PK_STATES IN ($_REQUEST[COMPANY_STATUS]) ";

// if ($_REQUEST['COMPANY_TYPE'] != '')
// 	$cond .= " AND S_COMPANY.PK_PLACEMENT_TYPE IN ($_REQUEST[COMPANY_TYPE]) ";

// if ($_REQUEST['COMPANY_WEBSITE'] != '') {
// 	$COMPANY_WEBSITE = trim($_REQUEST['COMPANY_WEBSITE']);
// 	$cond .= " AND trim(S_COMPANY.WEBSITE) = '$COMPANY_WEBSITE' ";
// }

// if ($_REQUEST['COMPANY_EVENT_COMPANY_CONTACT'] != '')
// 	$cond .= " AND S_COMPANY_EVENT.PK_COMPANY_CONTACT IN ($_REQUEST[COMPANY_EVENT_COMPANY_CONTACT]) ";

// if ($_REQUEST['COMPANY_EVENT_COMPLETE'] == 1)
// 	$cond .= " AND S_COMPANY_EVENT.COMPLETE = 1 ";
// else if ($_REQUEST['COMPANY_EVENT_COMPLETE'] == 2)
// 	$cond .= " AND S_COMPANY_EVENT.COMPLETE = 0 ";

// if ($_REQUEST['COMPANY_EVENT_BEGIN_DATE'] != '' && $_REQUEST['COMPANY_EVENT_END_DATE'] != '') {
// 	$COMPANY_EVENT_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_EVENT_BEGIN_DATE']));
// 	$COMPANY_EVENT_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['COMPANY_EVENT_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_EVENT.EVENT_DATE, '%Y-%m-%d') BETWEEN '$COMPANY_EVENT_BEGIN_DATE' AND '$COMPANY_EVENT_END_DATE' ";
// } else if ($_REQUEST['COMPANY_EVENT_BEGIN_DATE'] != '') {
// 	$COMPANY_EVENT_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_EVENT_BEGIN_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_EVENT.EVENT_DATE, '%Y-%m-%d') >= '$COMPANY_EVENT_BEGIN_DATE' ";
// } else if ($_REQUEST['COMPANY_EVENT_END_DATE'] != '') {
// 	$COMPANY_EVENT_END_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_EVENT_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_EVENT.EVENT_DATE, '%Y-%m-%d') <= '$COMPANY_EVENT_END_DATE' ";
// }

// if ($_REQUEST['COMPANY_EVENT_TYPE'] != '')
// 	$cond .= " AND S_COMPANY_EVENT.PK_PLACEMENT_COMPANY_EVENT_TYPE IN ($_REQUEST[COMPANY_EVENT_TYPE]) ";

// if ($_REQUEST['COMPANY_EVENT_FOLLOWUP_BEGIN_DATE'] != '' && $_REQUEST['COMPANY_EVENT_FOLLOWUP_END_DATE'] != '') {
// 	$COMPANY_EVENT_FOLLOWUP_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_EVENT_FOLLOWUP_BEGIN_DATE']));
// 	$COMPANY_EVENT_FOLLOWUP_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['COMPANY_EVENT_FOLLOWUP_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_EVENT.FOLLOW_UP_DATE, '%Y-%m-%d') BETWEEN '$COMPANY_EVENT_FOLLOWUP_BEGIN_DATE' AND '$COMPANY_EVENT_FOLLOWUP_END_DATE' ";
// } else if ($_REQUEST['COMPANY_EVENT_FOLLOWUP_BEGIN_DATE'] != '') {
// 	$COMPANY_EVENT_FOLLOWUP_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_EVENT_FOLLOWUP_BEGIN_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_EVENT.FOLLOW_UP_DATE, '%Y-%m-%d') >= '$COMPANY_EVENT_FOLLOWUP_BEGIN_DATE' ";
// } else if ($_REQUEST['COMPANY_EVENT_FOLLOWUP_END_DATE'] != '') {
// 	$COMPANY_EVENT_FOLLOWUP_END_DATE = date("Y-m-d", strtotime($_REQUEST['COMPANY_EVENT_FOLLOWUP_END_DATE']));

// 	$cond .= " AND DATE_FORMAT(S_COMPANY_EVENT.FOLLOW_UP_DATE, '%Y-%m-%d') <= '$COMPANY_EVENT_FOLLOWUP_END_DATE' ";
// }

// if ($_REQUEST['COMPANY_EVENT_SCHOOL_EMPLOYEE'] != '')
// 	$cond .= " AND S_COMPANY_EVENT.PK_COMPANY_CONTACT_EMPLOYEE IN ($_REQUEST[COMPANY_EVENT_SCHOOL_EMPLOYEE]) ";

// ////////////////////////
$having = "";

if(isset($_REQUEST['PK_LEDGER_CODE_GROUP'])){
	$imploded = implode(',',$_REQUEST['PK_LEDGER_CODE_GROUP']);
	$ar_ledger_codes = $db->Execute("SELECT GROUP_CONCAT(PK_AR_LEDGER_CODES) AS CONCATED_RES FROM S_LEDGER_CODE_GROUP WHERE PK_LEDGER_CODE_GROUP IN ($imploded) ");
	$ar_ledger_codes = explode(',' , $ar_ledger_codes->fields['CONCATED_RES']);
	$ar_ledger_codes = array_unique($ar_ledger_codes);
	$_REQUEST['PK_AR_LEDGER_CODE'] = $ar_ledger_codes;
	$_REQUEST['LEDGER_CODE'] = $ar_ledger_codes;	
}

if ($_REQUEST['LEDGER_BALANCE_FROM'] != '' || $_REQUEST['LEDGER_BALANCE_TO'] != '' || $_REQUEST['LEDGER_BATCH_DETAIL'] != '' || $_REQUEST['LEDGER_CHECK_NO'] != '' || $_REQUEST['LEDGER_CREDIT'] != '' || $_REQUEST['LEDGER_DEBIT'] != '' || $_REQUEST['LEDGER_DESCRIPTION'] != '' || $_REQUEST['LEDGER_GROSS_AMT_FROM'] != '' || $_REQUEST['LEDGER_GROSS_AMT_TO'] != '' || $_REQUEST['LEDGER_AY'] != '' || $_REQUEST['LEDGER_AP'] != '' || $_REQUEST['LEDGER_CODE'] != '' || $_REQUEST['LEDGER_NET_AMT_FROM'] != '' || $_REQUEST['LEDGER_NET_AMT_TO'] != '' || $_REQUEST['LEDGER_PAYMENT_TYPE_DETAIL'] != '' || $_REQUEST['LEDGER_PYA'] != '' || $_REQUEST['LEDGER_RECEIPT_NO'] != '' || $_REQUEST['LEDGER_SOURCE'] != '' || $_REQUEST['LEDGER_TERM_BLOCK'] != '' || $_REQUEST['LEDGER_TRANSACTION_FROM_DATE'] != '' || $_REQUEST['LEDGER_TRANSACTION_FROM_TO'] != '') {
	$table .= ", S_STUDENT_LEDGER 
	LEFT JOIN S_PAYMENT_BATCH_DETAIL AS PAYMENT_BATCH ON PAYMENT_BATCH.PK_PAYMENT_BATCH_DETAIL = S_STUDENT_LEDGER.PK_PAYMENT_BATCH_DETAIL 
	LEFT JOIN S_PAYMENT_BATCH_MASTER AS PAYMENT_BATCH_MASTER ON PAYMENT_BATCH_MASTER.PK_PAYMENT_BATCH_MASTER = PAYMENT_BATCH.PK_PAYMENT_BATCH_MASTER 
	LEFT JOIN S_STUDENT_DISBURSEMENT AS STUD_DISB ON STUD_DISB.PK_STUDENT_DISBURSEMENT = PAYMENT_BATCH.PK_STUDENT_DISBURSEMENT 
	LEFT JOIN S_MISC_BATCH_DETAIL as MISC_BATCH ON MISC_BATCH.PK_MISC_BATCH_DETAIL = S_STUDENT_LEDGER.PK_MISC_BATCH_DETAIL 
	LEFT JOIN S_MISC_BATCH_MASTER as MISC_BATCH_MASTER ON MISC_BATCH_MASTER.PK_MISC_BATCH_MASTER = MISC_BATCH.PK_MISC_BATCH_MASTER 
	LEFT JOIN S_TUITION_BATCH_DETAIL as TUITION_BATCH ON TUITION_BATCH.PK_TUITION_BATCH_DETAIL = S_STUDENT_LEDGER.PK_TUITION_BATCH_DETAIL LEFT JOIN S_TUITION_BATCH_MASTER AS TUITION_BATCH_MASTER ON TUITION_BATCH_MASTER.PK_TUITION_BATCH_MASTER = TUITION_BATCH.PK_TUITION_BATCH_MASTER ";

	$cond .= " AND S_STUDENT_LEDGER.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ";
}

if ($_REQUEST['LEDGER_BALANCE_FROM'] != '' && $_REQUEST['LEDGER_BALANCE_TO'] != '') {
	$having = " HAVING (SUM(S_STUDENT_LEDGER.DEBIT) - SUM(S_STUDENT_LEDGER.CREDIT) ) BETWEEN $_REQUEST[LEDGER_BALANCE_FROM] AND $_REQUEST[LEDGER_BALANCE_TO] ";
} else if ($_REQUEST['LEDGER_BALANCE_FROM'] != '') {
	$having = "HAVING (SUM(S_STUDENT_LEDGER.DEBIT) - SUM(S_STUDENT_LEDGER.CREDIT) ) >= $_REQUEST[LEDGER_BALANCE_FROM] ";
} else if ($_REQUEST['LEDGER_BALANCE_TO'] != '') {
	$having = " HAVING (SUM(S_STUDENT_LEDGER.DEBIT) - SUM(S_STUDENT_LEDGER.CREDIT) ) <= $_REQUEST[LEDGER_BALANCE_TO] ";
}

if ($_REQUEST['LEDGER_BATCH_DETAIL'] != '')
	$cond .= " AND S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT IN ($_REQUEST[LEDGER_BATCH_DETAIL]) ";

if ($_REQUEST['LEDGER_CHECK_NO'] != '')
	$cond .= " AND (MISC_BATCH.REF_NUMBER = '$_REQUEST[LEDGER_CHECK_NO]' OR PAYMENT_BATCH.CHECK_NO = '$_REQUEST[LEDGER_CHECK_NO]' ) ";

if ($_REQUEST['LEDGER_CREDIT'] != '')
	$cond .= " AND S_STUDENT_LEDGER.CREDIT = '$_REQUEST[LEDGER_CREDIT]' ";

if ($_REQUEST['LEDGER_DEBIT'] != '')
	$cond .= " AND S_STUDENT_LEDGER.DEBIT = '$_REQUEST[LEDGER_DEBIT]' ";

if ($_REQUEST['LEDGER_DESCRIPTION'] != '')
	$cond .= " AND (PAYMENT_BATCH.BATCH_DETAIL_DESCRIPTION = '$_REQUEST[LEDGER_DESCRIPTION]' OR MISC_BATCH.BATCH_DETAIL_DESCRIPTION = '$_REQUEST[LEDGER_DESCRIPTION]' OR TUITION_BATCH.BATCH_DETAIL_DESCRIPTION = '$_REQUEST[LEDGER_DESCRIPTION]' )";

if ($_REQUEST['LEDGER_GROSS_AMT_FROM'] != '' && $_REQUEST['LEDGER_GROSS_AMT_TO'] != '') {
	$cond .= " AND S_STUDENT_LEDGER.DISBURSEMENT_GROSS BETWEEN $_REQUEST[LEDGER_GROSS_AMT_FROM] AND $_REQUEST[LEDGER_GROSS_AMT_TO] ";
} else if ($_REQUEST['LEDGER_GROSS_AMT_FROM'] != '') {
	$cond .= " AND S_STUDENT_LEDGER.DISBURSEMENT_GROSS >= $_REQUEST[LEDGER_GROSS_AMT_FROM] ";
} else if ($_REQUEST['LEDGER_GROSS_AMT_TO'] != '') {
	$cond .= " AND S_STUDENT_LEDGER.DISBURSEMENT_GROSS <= $_REQUEST[LEDGER_GROSS_AMT_TO] ";
}

if ($_REQUEST['LEDGER_AY'] != '')
	$cond .= " AND (STUD_DISB.ACADEMIC_YEAR = '$_REQUEST[LEDGER_AY]' OR MISC_BATCH.AY = '$_REQUEST[LEDGER_AY]' OR TUITION_BATCH_MASTER.AY = '$_REQUEST[LEDGER_AY]' ) ";

if ($_REQUEST['LEDGER_AP'] != '')
	$cond .= " AND (STUD_DISB.ACADEMIC_PERIOD = '$_REQUEST[LEDGER_AP]' OR MISC_BATCH.AP = '$_REQUEST[LEDGER_AP]' OR TUITION_BATCH_MASTER.AP = '$_REQUEST[LEDGER_AP]' ) ";

if ($_REQUEST['LEDGER_CODE'] != '')
	$cond .= " AND S_STUDENT_LEDGER.PK_AR_LEDGER_CODE IN ($_REQUEST[LEDGER_CODE]) ";

if ($_REQUEST['LEDGER_PAYMENT_TYPE_DETAIL'] != '')
	$cond .= " AND MISC_BATCH.PAYMENT_MODE IN ($_REQUEST[LEDGER_PAYMENT_TYPE_DETAIL]) ";

if ($_REQUEST['LEDGER_PYA'] == 1)
	$cond .= " AND PAYMENT_BATCH.PRIOR_YEAR = 1 ";
else if ($_REQUEST['LEDGER_PYA'] == 2)
	$cond .= " AND PAYMENT_BATCH.PRIOR_YEAR = 0 ";

if ($_REQUEST['LEDGER_RECEIPT_NO'] != '')
	$cond .= " AND (PAYMENT_BATCH.RECEIPT_NO = '$_REQUEST[LEDGER_RECEIPT_NO]' OR MISC_BATCH.MISC_RECEIPT_NO = '$_REQUEST[LEDGER_RECEIPT_NO]') ";

if ($_REQUEST['LEDGER_SOURCE'] != '')
	$cond .= " AND (PAYMENT_BATCH_MASTER.BATCH_NO = '$_REQUEST[LEDGER_SOURCE]' OR MISC_BATCH_MASTER.BATCH_NO = '$_REQUEST[LEDGER_SOURCE]' OR TUITION_BATCH_MASTER.BATCH_NO = '$_REQUEST[LEDGER_SOURCE]' ) ";

if ($_REQUEST['LEDGER_TERM_BLOCK'] != '')
	$cond .= " AND (PAYMENT_BATCH.PK_TERM_BLOCK IN ($_REQUEST[LEDGER_TERM_BLOCK]) OR MISC_BATCH.PK_TERM_BLOCK IN ($_REQUEST[LEDGER_TERM_BLOCK]) OR TUITION_BATCH.PK_TERM_BLOCK IN ($_REQUEST[LEDGER_TERM_BLOCK])) ";

if ($_REQUEST['LEDGER_TRANSACTION_FROM_DATE'] != '' && $_REQUEST['LEDGER_TRANSACTION_FROM_TO'] != '') {
	$LEDGER_TRANSACTION_FROM_DATE = date("Y-m-d", strtotime($_REQUEST['LEDGER_TRANSACTION_FROM_DATE']));
	$LEDGER_TRANSACTION_FROM_TO 	= date("Y-m-d", strtotime($_REQUEST['LEDGER_TRANSACTION_FROM_TO']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_LEDGER.TRANSACTION_DATE, '%Y-%m-%d') BETWEEN '$LEDGER_TRANSACTION_FROM_DATE' AND '$LEDGER_TRANSACTION_FROM_TO' ";
} else if ($_REQUEST['LEDGER_TRANSACTION_FROM_DATE'] != '') {
	$LEDGER_TRANSACTION_FROM_DATE = date("Y-m-d", strtotime($_REQUEST['LEDGER_TRANSACTION_FROM_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_LEDGER.TRANSACTION_DATE, '%Y-%m-%d') >= '$LEDGER_TRANSACTION_FROM_DATE' ";
} else if ($_REQUEST['LEDGER_TRANSACTION_FROM_TO'] != '') {
	$LEDGER_TRANSACTION_FROM_TO = date("Y-m-d", strtotime($_REQUEST['LEDGER_TRANSACTION_FROM_TO']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_LEDGER.TRANSACTION_DATE, '%Y-%m-%d') <= '$LEDGER_TRANSACTION_FROM_TO' ";
}

//////////////
if ($_REQUEST['STUDENT_JOB_ACTIVE'] == 1)
	$cond .= " AND S_STUDENT_JOB.ACTIVE = 1 ";
else if ($_REQUEST['STUDENT_JOB_ACTIVE'] == 2)
	$cond .= " AND S_STUDENT_JOB.ACTIVE = 0 ";

if ($_REQUEST['STUDENT_JOB_ANNUAL_SALARY_FROM'] != '' && $_REQUEST['STUDENT_JOB_ANNUAL_SALARY_TO'] != '') {
	$cond .= " AND S_STUDENT_JOB.ANNUAL_SALARY BETWEEN $_REQUEST[STUDENT_JOB_ANNUAL_SALARY_FROM] AND $_REQUEST[STUDENT_JOB_ANNUAL_SALARY_TO] ";
} else if ($_REQUEST['STUDENT_JOB_ANNUAL_SALARY_FROM'] != '') {
	$cond .= " AND S_STUDENT_JOB.ANNUAL_SALARY >= $_REQUEST[STUDENT_JOB_ANNUAL_SALARY_FROM] ";
} else if ($_REQUEST['STUDENT_JOB_ANNUAL_SALARY_TO'] != '') {
	$cond .= " AND S_STUDENT_JOB.ANNUAL_SALARY <= $_REQUEST[STUDENT_JOB_ANNUAL_SALARY_TO] ";
}

if ($_REQUEST['STUDENT_JOB_COMPANY_NAME'] != '')
	$cond .= " AND S_STUDENT_JOB.PK_COMPANY IN ($_REQUEST[STUDENT_JOB_COMPANY_NAME]) ";

if ($_REQUEST['STUDENT_JOB_CURRENT_JOB'] == 1)
	$cond .= " AND S_STUDENT_JOB.CURRENT_JOB = 1 ";
else if ($_REQUEST['STUDENT_JOB_CURRENT_JOB'] == 2)
	$cond .= " AND S_STUDENT_JOB.CURRENT_JOB = 0 ";

if ($_REQUEST['STUDENT_JOB_DOCUMENT_FROM_DATE'] != '' && $_REQUEST['STUDENT_JOB_DOCUMENT_TO_DATE'] != '') {
	$STUDENT_JOB_DOCUMENT_FROM_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_DOCUMENT_FROM_DATE']));
	$STUDENT_JOB_DOCUMENT_TO_DATE 	= date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_DOCUMENT_TO_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.DOCUMENTED, '%Y-%m-%d') BETWEEN '$STUDENT_JOB_DOCUMENT_FROM_DATE' AND '$STUDENT_JOB_DOCUMENT_TO_DATE' ";
} else if ($_REQUEST['STUDENT_JOB_DOCUMENT_FROM_DATE'] != '') {
	$STUDENT_JOB_DOCUMENT_FROM_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_DOCUMENT_FROM_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.DOCUMENTED, '%Y-%m-%d') >= '$STUDENT_JOB_DOCUMENT_FROM_DATE' ";
} else if ($_REQUEST['STUDENT_JOB_DOCUMENT_TO_DATE'] != '') {
	$STUDENT_JOB_DOCUMENT_TO_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_DOCUMENT_TO_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.DOCUMENTED, '%Y-%m-%d') <= '$STUDENT_JOB_DOCUMENT_TO_DATE' ";
}

if ($_REQUEST['STUDENT_JOB_END_FROM_DATE'] != '' && $_REQUEST['STUDENT_JOB_END_TO_DATE'] != '') {
	$STUDENT_JOB_END_FROM_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_END_FROM_DATE']));
	$STUDENT_JOB_END_TO_DATE 	= date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_END_TO_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.END_DATE, '%Y-%m-%d') BETWEEN '$STUDENT_JOB_END_FROM_DATE' AND '$STUDENT_JOB_END_TO_DATE' ";
} else if ($_REQUEST['STUDENT_JOB_END_FROM_DATE'] != '') {
	$STUDENT_JOB_END_FROM_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_END_FROM_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.END_DATE, '%Y-%m-%d') >= '$STUDENT_JOB_END_FROM_DATE' ";
} else if ($_REQUEST['STUDENT_JOB_END_TO_DATE'] != '') {
	$STUDENT_JOB_END_TO_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_END_TO_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.END_DATE, '%Y-%m-%d') <= '$STUDENT_JOB_END_TO_DATE' ";
}

if ($_REQUEST['STUDENT_JOB_PART_FULL_TIME'] == 1)
	$cond .= " AND S_STUDENT_JOB.PK_FULL_PART_TIME = 1 ";
else if ($_REQUEST['STUDENT_JOB_PART_FULL_TIME'] == 2)
	$cond .= " AND S_STUDENT_JOB.PK_FULL_PART_TIME = 2 ";

if ($_REQUEST['STUDENT_JOB_INSTITUTIONAL_EMPLOYEMENT'] == 1)
	$cond .= " AND S_STUDENT_JOB.INSTITUTIONAL_EMPLOYMENT = 1 ";
else if ($_REQUEST['STUDENT_JOB_PART_FULL_TIME'] == 2)
	$cond .= " AND S_STUDENT_JOB.INSTITUTIONAL_EMPLOYMENT = 0 ";

if ($_REQUEST['STUDENT_JOB_STATUS'] != '')
	$cond .= " AND S_STUDENT_JOB.PK_PLACEMENT_STATUS IN ($_REQUEST[STUDENT_JOB_STATUS]) ";

if ($_REQUEST['STUDENT_JOB_TITLE'] != '')
	$cond .= " AND S_STUDENT_JOB.JOB_TITLE = '$_REQUEST[STUDENT_JOB_TITLE]' ";

if ($_REQUEST['STUDENT_JOB_TYPE'] != '')
	$cond .= " AND S_STUDENT_JOB.PK_PLACEMENT_STATUS IN ($_REQUEST[STUDENT_JOB_TYPE]) ";

if ($_REQUEST['STUDENT_JOB_PAY_AMOUNT_FROM'] != '' && $_REQUEST['STUDENT_JOB_PAY_AMOUNT_TO'] != '') {
	$cond .= " AND S_STUDENT_JOB.PAY_AMOUNT BETWEEN $_REQUEST[STUDENT_JOB_PAY_AMOUNT_FROM] AND $_REQUEST[STUDENT_JOB_PAY_AMOUNT_TO] ";
} else if ($_REQUEST['STUDENT_JOB_PAY_AMOUNT_FROM'] != '') {
	$cond .= " AND S_STUDENT_JOB.PAY_AMOUNT >= $_REQUEST[STUDENT_JOB_PAY_AMOUNT_FROM] ";
} else if ($_REQUEST['STUDENT_JOB_PAY_AMOUNT_TO'] != '') {
	$cond .= " AND S_STUDENT_JOB.PAY_AMOUNT <= $_REQUEST[STUDENT_JOB_PAY_AMOUNT_TO] ";
}

if ($_REQUEST['STUDENT_JOB_PAY_TYPE'] != '')
	$cond .= " AND S_STUDENT_JOB.PK_PAY_TYPE IN ($_REQUEST[STUDENT_JOB_PAY_TYPE]) ";

if ($_REQUEST['STUDENT_JOB_SELF_EMPLOYED'] == 1)
	$cond .= " AND S_STUDENT_JOB.SELF_EMPLOYED = 1 ";
else if ($_REQUEST['STUDENT_JOB_SELF_EMPLOYED'] == 2)
	$cond .= " AND S_STUDENT_JOB.SELF_EMPLOYED = 0 ";

if ($_REQUEST['STUDENT_JOB_SOC_CODE'] != '')
	$cond .= " AND S_STUDENT_JOB.PK_SOC_CODE IN ($_REQUEST[STUDENT_JOB_SOC_CODE]) ";

if ($_REQUEST['STUDENT_JOB_START_BEGIN_DATE'] != '' && $_REQUEST['STUDENT_JOB_START_END_DATE'] != '') {
	$STUDENT_JOB_START_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_START_BEGIN_DATE']));
	$STUDENT_JOB_START_END_DATE 	= date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_START_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.START_DATE, '%Y-%m-%d') BETWEEN '$STUDENT_JOB_START_BEGIN_DATE' AND '$STUDENT_JOB_START_END_DATE' ";
} else if ($_REQUEST['STUDENT_JOB_START_BEGIN_DATE'] != '') {
	$STUDENT_JOB_START_BEGIN_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_START_BEGIN_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.START_DATE, '%Y-%m-%d') >= '$STUDENT_JOB_START_BEGIN_DATE' ";
} else if ($_REQUEST['STUDENT_JOB_START_END_DATE'] != '') {
	$STUDENT_JOB_START_END_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_START_END_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.START_DATE, '%Y-%m-%d') <= '$STUDENT_JOB_START_END_DATE' ";
}

if ($_REQUEST['STUDENT_JOB_VERIFICATION_FROM_DATE'] != '' && $_REQUEST['STUDENT_JOB_VERIFICATION_TO_DATE'] != '') {
	$STUDENT_JOB_VERIFICATION_FROM_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_VERIFICATION_FROM_DATE']));
	$STUDENT_JOB_VERIFICATION_TO_DATE 	= date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_VERIFICATION_TO_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.VERIFICATION_DATE, '%Y-%m-%d') BETWEEN '$STUDENT_JOB_VERIFICATION_FROM_DATE' AND '$STUDENT_JOB_VERIFICATION_TO_DATE' ";
} else if ($_REQUEST['STUDENT_JOB_VERIFICATION_FROM_DATE'] != '') {
	$STUDENT_JOB_VERIFICATION_FROM_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_VERIFICATION_FROM_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.VERIFICATION_DATE, '%Y-%m-%d') >= '$STUDENT_JOB_VERIFICATION_FROM_DATE' ";
} else if ($_REQUEST['STUDENT_JOB_VERIFICATION_TO_DATE'] != '') {
	$STUDENT_JOB_VERIFICATION_TO_DATE = date("Y-m-d", strtotime($_REQUEST['STUDENT_JOB_VERIFICATION_TO_DATE']));

	$cond .= " AND DATE_FORMAT(S_STUDENT_JOB.VERIFICATION_DATE, '%Y-%m-%d') <= '$STUDENT_JOB_VERIFICATION_TO_DATE' ";
}

if ($_REQUEST['STUDENT_JOB_VERIFICATION_SOURCE'] != '')
	$cond .= " AND S_STUDENT_JOB.PK_PLACEMENT_VERIFICATION_SOURCE IN ($_REQUEST[STUDENT_JOB_VERIFICATION_SOURCE]) ";

if ($_REQUEST['STUDENT_JOB_WEEKLY_HOUR_FROM'] != '' && $_REQUEST['STUDENT_JOB_WEEKLY_HOUR_TO'] != '') {
	$cond .= " AND S_STUDENT_JOB.WEEKLY_HOURS BETWEEN $_REQUEST[STUDENT_JOB_WEEKLY_HOUR_FROM] AND $_REQUEST[STUDENT_JOB_WEEKLY_HOUR_TO] ";
} else if ($_REQUEST['STUDENT_JOB_WEEKLY_HOUR_FROM'] != '') {
	$cond .= " AND S_STUDENT_JOB.WEEKLY_HOURS >= $_REQUEST[STUDENT_JOB_WEEKLY_HOUR_FROM] ";
} else if ($_REQUEST['STUDENT_JOB_WEEKLY_HOUR_TO'] != '') {
	$cond .= " AND S_STUDENT_JOB.WEEKLY_HOURS <= $_REQUEST[STUDENT_JOB_WEEKLY_HOUR_TO] ";
}
//student_type
if ($_REQUEST['student_type'] == "students") {
	// $cond .= " AND TRIM(LOWER(STUDENT_STATUS)) = 'lead' ";
	$cond .= " AND M_STUDENT_STATUS.ADMISSIONS = 0 AND IS_ACTIVE_ENROLLMENT = 1  AND S_STUDENT_MASTER.ARCHIVED = 0 ";
} else if ($_REQUEST['student_type'] == "Lead") {
	// $cond .= " AND TRIM(LOWER(STUDENT_STATUS)) != 'lead' ";
	$cond .= " AND M_STUDENT_STATUS.ADMISSIONS = 1 AND IS_ACTIVE_ENROLLMENT = 1  AND  S_STUDENT_MASTER.ARCHIVED = 0 ";
} else if ($_REQUEST['student_type'] == "archived") {
	// $cond .= " AND TRIM(LOWER(STUDENT_STATUS)) != 'lead' ";
	$cond .= " AND S_STUDENT_MASTER.ARCHIVED = 1 ";
}


//enrollment_type
if ($_REQUEST['enrollment_type'] == "current") {
	$cond .= " AND IS_ACTIVE_ENROLLMENT = 1 ";
} else {
	// $cond .= " AND IS_ACTIVE_ENROLLMENT != 1 ";
}

//GET ALL FIELDS -> compare with sql 
// preg_match_all('/\b([A-Z_]+)\b/u', $cond, $matches);
// echo "<pre>";
// print_r($cond);
// echo '-----';
// print_r($matches);

$djoins = get_joins($cond);




$query = "select *,PK_CAMPUS,S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT, CONCAT(LAST_NAME,', ',FIRST_NAME,' ',MIDDLE_NAME) as STU_NAME, IF(S_TERM_MASTER.BEGIN_DATE = '0000-00-00','', DATE_FORMAT(S_TERM_MASTER.BEGIN_DATE, '%m/%d/%Y' )) AS  BEGIN_DATE_1, STUDENT_STATUS  ,S_STUDENT_MASTER.PK_STUDENT_MASTER
FROM S_STUDENT_MASTER 
LEFT JOIN S_STUDENT_RACE ON S_STUDENT_RACE.PK_STUDENT_MASTER = S_STUDENT_MASTER.PK_STUDENT_MASTER 
LEFT JOIN S_STUDENT_ACADEMICS ON S_STUDENT_ACADEMICS.PK_STUDENT_MASTER = S_STUDENT_MASTER.PK_STUDENT_MASTER 
, S_STUDENT_ENROLLMENT 
LEFT JOIN S_TERM_MASTER ON S_TERM_MASTER.PK_TERM_MASTER = S_STUDENT_ENROLLMENT.PK_TERM_MASTER 
LEFT JOIN M_STUDENT_STATUS ON M_STUDENT_STATUS.PK_STUDENT_STATUS = S_STUDENT_ENROLLMENT.PK_STUDENT_STATUS 

$djoins

LEFT JOIN S_STUDENT_CAMPUS ON S_STUDENT_CAMPUS.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT 


$table
WHERE 
S_STUDENT_ENROLLMENT.PK_STUDENT_MASTER = S_STUDENT_MASTER.PK_STUDENT_MASTER AND 
S_STUDENT_MASTER.PK_ACCOUNT = '$_SESSION[PK_ACCOUNT]'   $cond 
GROUP BY S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT $having ORDER BY CONCAT(S_STUDENT_MASTER.LAST_NAME,', ', S_STUDENT_MASTER.FIRST_NAME) ASC , BEGIN_DATE DESC";

$res_type = $db->Execute($query);
$_SESSION['custome_query_cache'] = $query;
$log_array = array('SQL_QUERY' => $query, 'PK_ACCOUNT' => $_SESSION['PK_ACCOUNT'], 'PK_USER' => $_SESSION['PK_USER'], 'REPORT_NAME' => 'Student Report Selection');
log_query($log_array);
// echo "<pre>";
// print_r(array_keys($res_type->fields));

// echo $query;exit;
// exit;


$filters = [["PK_CITIZENSHIP", "Citizenship"], ["PK_COUNTRY_CITIZEN", "Country/Citizen"], ["DOB_START_DATE", "DOB Begin Date"], ["DOB_END_DATE", "DOB End Date"], ["PK_DRIVERS_LICENSE_STATE", "Drivers License State"], ["FERPA_BLOCK", "FERPA Block"], ["GENDER", "Gender"], ["PK_HIGHEST_LEVEL_OF_EDU", "Highest level of Ed."], ["IPEDS_ETHNICITY", "IPEDS Ethnicity"], ["PK_MARITAL_STATUS", "Marital Status"], ["PREVIOUS_COLLEGE", "Previous College"], ["PK_RACE", "Race"], ["SSN_VERIFIED", "SSN Verified"], ["PK_STATE_OF_RESIDENCY", "State of Residency"], ["PK_1098T_REPORTING_TYPE", "1098T Reporting"], ["PK_REPRESENTATIVE", "Admission Rep"], ["ATTENDANCE_BEGIN_DATE", "Attendance Begin Date"], ["ATTENDANCE_END_DATE", "Attendance End Date"], ["PK_CAMPUS", "Campus"], ["PK_SPECIAL", "COE CPL Special"], ["PK_LEAD_CONTACT_SOURCE", "Contact Source"], ["CONTRACT_END_DATE_BEGIN", "Contract End (From)"], ["CONTRACT_END_DATE_END", "Contract End (Till)"], ["CONTRACT_SIGNED_BEGIN_DATE", "Contract Signed Begin Date"], ["CONTRACT_SIGNED_END_DATE", "Contract Signed End Date"], ["DETERMINATION_BEGIN_DATE", "Determination Begin Date"], ["DETERMINATION_END_DATE", "Determination End Date"], ["PK_DISTANCE_LEARNING", "Distance Learning"], ["DROP_BEGIN_DATE", "Drop Begin Date"], ["DROP_END_DATE", "Drop End Date"], ["PK_DROP_REASON", "Drop Reason"], ["EXPECTED_GRAD_BEGIN_DATE", "Expected Grad Begin Date"], ["EXPECTED_GRAD_END_DATE", "Expected Grad End Date"], ["TERM_BEGIN_DATE", "First Term Begin Date"], ["TERM_END_DATE", "First Term End Date"], ["FT_PT_EFFECTIVE_BEGIN_DATE", "FT-PT Effective Begin Date"], ["FT_PT_EFFECTIVE_END_DATE", "FT-PT Effective End Date"], ["PK_ENROLLMENT_STATUS", "Full/Part Time"], ["PK_FUNDING", "Funding"], ["GRADE_BEGIN_DATE", "Grad Begin Date"], ["GRADE_END_DATE", "Grad End Date"], ["FIRST_TERM", "IPEDS Enrollment Status"], ["LDA_BEGIN_DATE", "LDA Begin Date"], ["LDA_END_DATE", "LDA End Date"], ["ENTRY_BEGIN_DATE", "Entry Begin Date"], ["ENTRY_END_DATE", "Entry End Date"], ["PK_LEAD_SOURCE", "Lead Source"], ["MIDPOINT_BEGIN_DATE", "Mid Point Begin Date"], ["MIDPOINT_END_DATE", "Mid Point End Date"], ["ORIGINAL_EXPECTED_GRAD_BEGIN_DATE", "Original Expected Grad Begin Date"], ["ORIGINAL_EXPECTED_GRAD_END_DATE", "Original Expected Grad End Date"], ["PK_PLACEMENT_STATUS", "Placement Status"], ["PK_CAMPUS_PROGRAM", "Program"], ["REENTRY", "Re-Entry"], ["PK_SAP_GROUP", "SAP Group"], ["PK_SESSION", "Session"], ["PK_STUDENT_STATUS", "Student Status"], ["STATUS_BEGIN_DATE", "Status Begin Date"], ["STATUS_END_DATE", "Status End Date"], ["STRF_PAID_BEGIN_DATE", "STRF Paid Begin Date"], ["STRF_PAID_END_DATE", "STRF Paid End Date"], ["PK_STUDENT_GROUP", "Student Group"], ["ENROLLMENT_PK_TERM_BLOCK", "Term Block"], ["TRANSFER_IN", "Transfer In"], ["EMAIL_SENT_ON_BEGIN_DATE", "Email Sent On Begin Date"], ["EMAIL_SENT_ON_END_DATE", "Email Sent On End Date"], ["EVENT_COMPLETED", "Event Completed"], ["EVENT_BEGIN_DATE", "Event Begin Date"], ["EVENT_END_DATE", "Event End Date"], ["EVENT_EMPLOYEE", "Event Employee"], ["EVENT_FOLLOWUP_BEGIN_DATE", "Event Followup Begin Date"], ["EVENT_FOLLOWUP_END_DATE", "Event Followup End Date"], ["EVENT_OTHER", "Event Other"], ["EVENT_STATUS", "Event Status"], ["EVENT_TYPE", "Event Type"], ["INTERNAL_MSG_SENT_FROM", "Internal Message Sent From"], ["INTERNAL_MSG_SENT_ON_BEGIN_DATE", "Internal Message Sent From Begin Date"], ["INTERNAL_MSG_SENT_ON_END_DATE", "Internal Message Sent From End Date"], ["LOA_BEGIN_DATE", "LOA Begin Date"], ["LOA_END_DATE", "LOA End Date"], ["LOA_NO_OF_DAYS_FROM", "LOA No. of Days (From)"], ["LOA_NO_OF_DAYS_TO", "LOA No. of Days(To)"], ["NOTES_COMPLETED", "Notes Completed"], ["NOTE_BEGIN_DATE", "Notes Begin Date"], ["NOTE_END_DATE", "Notes End Date"], ["NOTES_EMPLOYEE", "Notes Employee"], ["NOTES_FOLLOWUP_BEGIN_DATE", "Notes Followup Begin Date"], ["NOTES_FOLLOWUP_END_DATE", "Notes Followup End Date"], ["NOTE_STATUS", "Note Status"], ["NOTE_TYPE", "Note Type"], ["PROBATION_BEGIN_DATE", "Probation Begin Date"], ["PROBATION_END_DATE", "Probation End Date"], ["PROBATION_LEVEL", "Probation Level"], ["PROBATION_STATUS", "Probation Status"], ["PROBATION_TYPE", "Probation Type"], ["TASK_ATTACHMENT", "Task Attachment"], ["TASK_COMPLETED", "Task Completed"], ["TASK_BEGIN_DATE", "Task Begin Date"], ["TASK_END_DATE", "Task End Date"], ["TASK_EMPLOYEE", "Task Employee"], ["TASK_FOLLOWUP_BEGIN_DATE", "Task Followup Begin Date"], ["TASK_FOLLOWUP_END_DATE", "Task Followup End Date"], ["TASK_OTHER", "Task Other"], ["TASK_PRIORITY", "Task Priority"], ["TASK_STATUS", "Task Status"], ["TASK_TYPE", "Task Type"], ["TEXT_CELL_NUMBER", "Cell Number"], ["TEXT_BEGIN_DATE", "Text Sent On Begin Date"], ["TEXT_END_DATE", "Text Sent On End Date"], ["TEXT_DEPARTMENT", "Text Department"], ["TEXT_EMPLOYEE", "Text Employee"], ["TEXT_STATUS", "Text Status"], ["DOC_DATE_RECEIVED_BEGIN_DATE", "Document Received Begin Date"], ["DOC_DATE_RECEIVED_END_DATE", "Document Received End Date"], ["DOC_DEPARTMENT", "Department"], ["DOC_EMPLOYEE", "Employee"], ["DOC_DATE_FOLLOWUP_BEGIN_DATE", "Document Follow Up Begin Date"], ["DOC_DATE_FOLLOWUP_END_DATE", "Document Follow Up End Date"], ["DOC_NAME", "Document name"], ["DOC_RECEIVED", "Document Received"], ["DOC_DATE_REQUESTED_BEGIN_DATE", "Document Date Requested Begin Date"], ["DOC_DATE_REQUESTED_END_DATE", "Document Date Requested End Date"], ["REQUIREMENT", "Requirement"], ["REQUIREMENT_CATEGORY", "Requirement Category"], ["REQUIREMENT_COMPLETED", "Requirement Completed"], ["REQUIREMENT_COMPLETED_ON_BEGIN_DATE", "Requirement Completed Begin Date"], ["REQUIREMENT_COMPLETED_ON_END_DATE", "Requirement Completed End Date"], ["REQUIREMENT_TYPE", "Requirement Type"], ["OTHER_EDU_EDU_TYPE", "Type"], ["OTHER_EDU_GRADUATED", "Graduated"], ["OTHER_EDU_GRADUATED_BEGIN_DATE", "Graduated Begin Date"], ["OTHER_EDU_GRADUATED_END_DATE", "Graduated End Date"], ["OTHER_EDU_SCHOOL_CITY", "School City"], ["OTHER_EDU_SCHOOL_FAX", "School Fax"], ["OTHER_EDU_SCHOOL_NAME", "School Name"], ["OTHER_EDU_SCHOOL_PHONE", "School Phone"], ["OTHER_EDU_SCHOOL_STATE", "School State"], ["OTHER_EDU_SCHOOL_ZIP", "School Zip"], ["OTHER_EDU_TRANSCRIPT_RECEIVED", "Transcript Received"], ["OTHER_EDU_TRANSCRIPT_RECEIVED_BEGIN_DATE", "Transcript Received Begin Date"], ["OTHER_EDU_TRANSCRIPT_RECEIVED_END_DATE", "Transcript Received End Date"], ["OTHER_EDU_TRANSCRIPT_REQUESTED", "Transcript Requested"], ["OTHER_EDU_TRANSCRIPT_REQUESTED_BEGIN_DATE", "Transcript Requested Begin Date"], ["OTHER_EDU_TRANSCRIPT_REQUESTED_END_DATE", "Transcript Requested End Date"], ["DISBURSEMENT_AP", "Acadamic Period"], ["DISBURSEMENT_APPROVED_BEGIN_DATE", "Approved Begin Date"], ["DISBURSEMENT_APPROVED_END_DATE", "Approved End Date"], ["DISBURSEMENT_AWARD_YEAR", "Award Year"], ["DISBURSEMENT_AY", "Acadamic Year"], ["DISBURSEMENT_BATCH", "Batch"], ["DISBURSEMENT_DEPOSITED_BEGIN_DATE", "Deposited Begin Date"], ["DISBURSEMENT_DEPOSITED_END_DATE", "Deposited End Date"], ["DISBURSEMENT_AMOUNT_FROM", "Disbursement Amount (From)"], ["DISBURSEMENT_AMOUNT_TO", "Disbursement Amount(To)"], ["DISBURSEMENT_BEGIN_DATE", "Disbursement Begin Date"], ["DISBURSEMENT_END_DATE", "Disbursement End Date"], ["DISBURSEMENT_FUND_REQUESTED", "Disbursement Fund Requested"], ["DISBURSEMENT_HOURS_REQUIRED", "Disbursement Hours Required"], ["DISBURSEMENT_LEDGER_CODE", "Ledger Code"], ["DISBURSEMENT_STATUS", "Disbursement Status"], ["ESTIMATED_FEES_AP", "Estimated Fees Acadamic Period"], ["ESTIMATED_FEES_APPROVED_BEGIN_DATE", "Estimated Fees Approved Begin Date"], ["ESTIMATED_FEES_APPROVED_END_DATE", "Estimated Fees Approved End Date"], ["ESTIMATED_FEES_AY", "Estimated Fees Acadamic Year"], ["ESTIMATED_FEES_BATCH", "Batch"], ["ESTIMATED_FEES_BEGIN_DATE", "Estimated Fees Begin Date"], ["ESTIMATED_FEES_END_DATE", "Estimated Fees End Date"], ["ESTIMATED_FEES_FROM_AMOUNT", "Estimated Fees Amount (From)"], ["ESTIMATED_FEES_TO_AMOUNT", "Estimated Fees Amount(To)"], ["ESTIMATED_FEES_FEE_TYPE", "Estimated Fees Type"], ["ESTIMATED_FEES_LEDGER_CODE", "Estimated Fees Ledger Code"], ["ESTIMATED_FEES_FEE_STATUS", "Estimated Fees Status"], ["ESTIMATED_FEES_TRANS_BEGIN_DATE", "Estimated Fees Transaction Begin Date"], ["ESTIMATED_FEES_TRANS_END_DATE", "Estimated Fees Transaction End Date"], ["COMPANY_CITY", "Company City"], ["COMPANY_NAME", "Company Name"], ["COMPANY_SOURCE", "Company Source"], ["COMPANY_DATE_CREATED_BEGIN_DATE", "Company Created Begin Date"], ["COMPANY_DATE_CREATED_END_DATE", "Company Created End Date"], ["COMPANY_FAX", "Company Fax"], ["COMPANY_MAIN_CONTACT", "Company Main Contact"], ["COMPANY_OPEN_JOB", "Company Open Job"], ["COMPANY_PHONE", "Company Phone"], ["COMPANY_SCHOOL_EMPLOYEE", "Company School Employee"], ["COMPANY_STATE", "Company State"], ["COMPANY_STATUS", "Company Status"], ["COMPANY_TOTAL_JOBS", "Company Total Jobs"], ["COMPANY_TYPE", "Company Type"], ["COMPANY_WEBSITE", "Company Website"], ["COMPANY_EVENT_COMPANY_CONTACT", "Company Event Contact"], ["COMPANY_EVENT_COMPLETE", "Company Event Completed"], ["COMPANY_EVENT_BEGIN_DATE", "Company Event Begin Date"], ["COMPANY_EVENT_END_DATE", "Company Event End Date"], ["COMPANY_EVENT_TYPE", "Company Event Type"], ["COMPANY_EVENT_FOLLOWUP_BEGIN_DATE", "Company Event Follow Up Begin Date"], ["COMPANY_EVENT_FOLLOWUP_END_DATE", "Company Event Follow Up End Date"], ["COMPANY_EVENT_SCHOOL_EMPLOYEE", "Company Event School Employee"], ["COMPANY_JOB_FULL_PART_TIME", "Company Job Full/Part Time"], ["COMPANY_JOB_CANCELLED_BEGIN_DATE", "Company Job Cancelled Begin Date"], ["COMPANY_JOB_CANCELLED_END_DATE", "Company Job Cancelled End Date"], ["COMPANY_JOB_FILLED_BEGIN_DATE", "Company Job Filled Begin Date"], ["COMPANY_JOB_FILLED_END_DATE", "Company Job Filled End Date"], ["COMPANY_JOB_NO", "Company Job No."], ["COMPANY_JOB_POSTED_DATE_BEGIN_DATE", "Company Job Posted Begin Date"], ["COMPANY_JOB_POSTED_DATE_END_DATE", "Company Job Posted End Date"], ["COMPANY_JOB_TITLE", "Company Job Title"], ["COMPANY_JOB_OPEN_JOB", "Company Open Job"], ["COMPANY_JOB_PAY_AMOUNT_FROM", "Company Job Pay Amount (From)"], ["COMPANY_JOB_PAY_AMOUNT_TO", "Company Job Pay Amount(To)"], ["LEDGER_BALANCE_FROM", "Ledger Balance (From)"], ["LEDGER_BALANCE_TO", "Ledger Balance(To)"], ["LEDGER_BATCH_DETAIL", "Ledger batch Detail"], ["LEDGER_CHECK_NO", "Ledger Check #"], ["LEDGER_CREDIT", "Ledger Credit"], ["LEDGER_DEBIT", "Ledger Debit"], ["LEDGER_DESCRIPTION", "Ledger Description"], ["LEDGER_GROSS_AMT_FROM", "Ledger Gross Amount (From)"], ["LEDGER_GROSS_AMT_TO", "Ledger Gross Amount(To)"], ["LEDGER_AY", "Ledger Academic Year"], ["LEDGER_AP", "Ledger Acadamic Period"], ["LEDGER_CODE", "Ledger Code"], ["LEDGER_NET_AMT_FROM", "Ledger Net Amount (From)"], ["LEDGER_NET_AMT_TO", "Ledger Net Amount(To)"], ["LEDGER_PAYMENT_TYPE_DETAIL", "Ledger Payment Type Detail"], ["LEDGER_PYA", "Ledger PYA"], ["LEDGER_RECEIPT_NO", "Ledger Receipt #"], ["LEDGER_SOURCE", "Ledger Source"], ["LEDGER_TERM_BLOCK", "Ledger Term Block"], ["LEDGER_TRANSACTION_FROM_DATE", "Ledger Transaction Begin Date"], ["LEDGER_TRANSACTION_FROM_TO", "Ledger Transaction End Date"], ["STUDENT_JOB_ACTIVE", "Student Job Active"], ["STUDENT_JOB_ANNUAL_SALARY_FROM", "Student Job Annual Salary (From)"], ["STUDENT_JOB_ANNUAL_SALARY_TO", "Student Job Annual Salary(To)"], ["STUDENT_JOB_COMPANY_NAME", "Student Job Company name"], ["STUDENT_JOB_CURRENT_JOB", "Student Job Current Job"], ["STUDENT_JOB_DOCUMENT_FROM_DATE", "Student Job Document Date Begin Date"], ["STUDENT_JOB_DOCUMENT_TO_DATE", "Student Job Document Date End Date"], ["STUDENT_JOB_END_FROM_DATE", "Student Job End Date (From)"], ["STUDENT_JOB_END_TO_DATE", "Student Job End Date (Till)"], ["STUDENT_JOB_PART_FULL_TIME", "Student Job Full/Part Time"], ["STUDENT_JOB_INSTITUTIONAL_EMPLOYEMENT", "Institutional Employement"], ["STUDENT_JOB_STATUS", "Student Job Status"], ["STUDENT_JOB_TITLE", "Student Job Title"], ["STUDENT_JOB_TYPE", "Student Job Type"], ["STUDENT_JOB_PAY_AMOUNT_FROM", "Student Job Pay Amount (From)"], ["STUDENT_JOB_PAY_AMOUNT_TO", "Student Job Pay Amount(To)"], ["STUDENT_JOB_PAY_TYPE", "Student Job Pay Type"], ["STUDENT_JOB_SELF_EMPLOYED", "Student Job Self Employed"], ["STUDENT_JOB_SOC_CODE", "Student Job SOC code"], ["STUDENT_JOB_START_BEGIN_DATE", "Student Job Start Date (From)"], ["STUDENT_JOB_START_END_DATE", "Student Job Start Date (Till)"], ["STUDENT_JOB_VERIFICATION_FROM_DATE", "Student Job Verification Begin Date"], ["STUDENT_JOB_VERIFICATION_TO_DATE", "Student Job Verification End Date"], ["STUDENT_JOB_VERIFICATION_SOURCE", "Student Job Verification Source"], ["STUDENT_JOB_WEEKLY_HOUR_FROM", "Student Job Weekly From"], ["STUDENT_JOB_WEEKLY_HOUR_TO", "Student Job Weekly From(To)"]];

$selected_columns = false;
if (isset($_REQUEST['selected_columns'])) {
	if ($_REQUEST['selected_columns'] != '') {
		$selected_columns = explode(',', $_REQUEST['selected_columns']);
	}
}
$multi_selects = [
	"PK_CITIZENSHIP",
	"PK_COUNTRY_CITIZEN",
	"PK_DRIVERS_LICENSE_STATE",
	"PK_HIGHEST_LEVEL_OF_EDU",
	"PK_MARITAL_STATUS",
	"PK_RACE",
	"PK_STATE_OF_RESIDENCY",
	"PK_1098T_REPORTING_TYPE",
	"PK_REPRESENTATIVE",
	"PK_CAMPUS",
	"PK_SPECIAL",
	"PK_LEAD_CONTACT_SOURCE",
	"PK_DISTANCE_LEARNING",
	"PK_DROP_REASON",
	"PK_ENROLLMENT_STATUS",
	"PK_FUNDING",
	"FIRST_TERM",
	"PK_LEAD_SOURCE",
	"PK_PLACEMENT_STATUS",
	"PK_CAMPUS_PROGRAM",
	"PK_SAP_GROUP",
	"PK_SESSION",
	"PK_STUDENT_STATUS",
	"PK_STUDENT_GROUP",
	"EVENT_EMPLOYEE",
	"EVENT_OTHER",
	"EVENT_STATUS",
	"EVENT_TYPE",
	"INTERNAL_MSG_SENT_FROM",
	"NOTES_EMPLOYEE",
	"NOTE_STATUS",
	"NOTE_TYPE",
	"PROBATION_LEVEL",
	"PROBATION_STATUS",
	"PROBATION_TYPE",
	"TASK_EMPLOYEE",
	"TASK_OTHER",
	"TASK_PRIORITY",
	"TASK_STATUS",
	"TASK_TYPE",
	"TEXT_DEPARTMENT",
	"TEXT_EMPLOYEE",
	"INTERNAL_MSG_SENT_FROM",
	"DOC_DEPARTMENT",
	"DOC_EMPLOYEE",
	"REQUIREMENT_CATEGORY",
	"OTHER_EDU_EDU_TYPE",
	"OTHER_EDU_SCHOOL_STATE",
	"DISBURSEMENT_AWARD_YEAR",
	"DISBURSEMENT_LEDGER_CODE",
	"DISBURSEMENT_STATUS",
	"ESTIMATEDDOC_EMPLOYEE",
	"REQUIREMENT_CATEGORY",
	"OTHER_EDU_EDU_TYPE",
	"OTHER_EDU_SCHOOL_STATE",
	"DISBURSEMENT_AWARD_YEAR",
	"DISBURSEMENT_LEDGER_CODE",
	"DISBURSEMENT_STATUS",
	"ESTIMATED_FEES_FEE_TYPE",
	"COMPANY_MAIN_CONTACT",
	"COMPANY_SCHOOL_EMPLOYEE",
	"COMPANY_SCHOOL_EMPLOYEE",
	"COMPANY_STATE",
	"COMPANY_STATUS",
	"COMPANY_TYPE",
	"COMPANY_EVENT_COMPANY_CONTACT",
	"COMPANY_EVENT_TYPE",
	"COMPANY_EVENT_SCHOOL_EMPLOYEE",
	"LEDGER_BATCH_DETAIL",
	"LEDGER_CODE",
	"LEDGER_PAYMENT_TYPE_DETAIL",
	"LEDGER_TERM_BLOCK",
	"STUDENT_JOB_STATUS",
	"STUDENT_JOB_TYPE",
	"STUDENT_JOB_PAY_TYPE",
	"STUDENT_JOB_SOC_CODE",
	"STUDENT_JOB_VERIFICATION_SOURCE",
	"STUDENT_JOB_COMPANY_NAME"

];
ini_set('max_execution_time', '0');

$global_cache = new ApcCache();
$data = [];
while (!$res_type->EOF) {
	// echo "<pre>";
	// print_r($res_type->fields);
	// exit;
	$row = [];
	if (!in_array($res_type->fields['PK_STUDENT_ENROLLMENT'], $PK_STUDENT_ENROLLMENT_ARR)) {
		// $row[] = ''; // for checkbox
		$row[] = $res_type->fields['PK_STUDENT_ENROLLMENT'];
		$row[] = $res_type->fields['STU_NAME'];
		$row[] = $res_type->fields['STUDENT_ID'];
		// echo " CALLING GetValueFromCache 'PK_CAMPUS',". $res_type->fields['PK_CAMPUS'];
		$row[] = $global_cache->GetValueFromCache('PK_CAMPUS', $res_type->fields['PK_CAMPUS']);
		$row[] = $res_type->fields['BEGIN_DATE'];
		$row[] = $global_cache->GetValueFromCache('PK_CAMPUS_PROGRAM', $res_type->fields['PK_CAMPUS_PROGRAM']);
		$row[] = $res_type->fields['STUDENT_STATUS'];
		$row[] = $global_cache->GetValueFromCache('PK_STUDENT_GROUP', $res_type->fields['PK_STUDENT_GROUP']);


		


		// echo "<pre>";
		// print_r("hello there");
		// print_r($res_type->fields);
		// exit;
		if ($selected_columns) {

			foreach ($selected_columns as $key => $value) {
				if (in_array($value, $multi_selects)) {
					// $debug_key = 'PK_FUNDING';
					// if($value == "$debug_key"){
					// 	echo $debug_key." FOUND";
					// }
					#use either this block OR ...
					// $filter_key = array_search($value, array_column($filters, 0));
					// $row[$filters[$filter_key][1]] = $global_cache->GetValueFromCache($value, $res_type->fields[$value]);
					#...OR(continued)
					$row[] = $global_cache->GetValueFromCache($value, $res_type->fields[$value]);
				}
				//else if(){
				// #check for select and dates and other type of fields
				//}
				else {
					//  if($value == 'IPEDS_ETHNICITY'){
					// 	echo "what is IPEDS_ETHNICITY ?".$global_cache->GetValueFromCache($value, $res_type->fields[$value])."<<";exit;
					//  }
					$cached_Data = $global_cache->GetValueFromCache($value, $res_type->fields[$value]);
					if ($cached_Data != null) {
						$row[] = $cached_Data;
					} else {
						if ($value == 'ENROLLMENT_PK_TERM_BLOCK' && $res_type->fields[$value] == 0) {
							$row[] = '--';
						} else
							$row[] = $res_type->fields[$value];
					};
					// exit;
				}
			}
		}
		// echo "<pre>";
		// print_r($row);
		// exit;
		//if()

		#check if data is of multi-select type if yes fetch from cache 
		$data[] = $row;
	}
	$res_type->MoveNext();
}

$response['data'] = $data;
$response['query'] = $query;
preg_match_all('/\b([A-Z_]+)\b/u', $cond, $matches);
$response['condition'] = $matches;
header('Content-Type: application/json; charset=utf-8');
echo json_encode($response);




function get_joins($cond)
{

	preg_match_all('/\b([A-Z_]+)\b/u', $cond, $matches);



	$unique['S_STUDENT_SCHEDULE'] = ['PK_STUDENT_SCHEDULE', 'PK_STUDENT_COURSE', 'PK_COURSE_OFFERING_SCHEDULE_DETAIL', 'PK_SCHEDULE_TYPE', 'SCHEDULE_DATE', 'START_TIME', 'END_TIME', 'HOURS', 'PK_CAMPUS_ROOM', /*'OLD_DSIS_ID'*/];
	$unique['S_STUDENT_JOB'] = ['PK_STUDENT_JOB', 'PK_FULL_PART_TIME', 'COMPANY_PHONE', 'SUPERVISOR', 'CURRENT_JOB', 'START_DATE', 'DOCUMENTED', 'PK_IN_FIELD', 'PK_PLACEMENT_VERIFICATION_SOURCE', 'VERIFICATION_DATE'];
	$unique['S_COMPANY_JOB'] = ['OLD_DSIS_COMPANY_JOB_ID', 'JOB_NUMBER', 'JOB_POSTED', 'JOB_FILLED', 'JOB_CANCELED', 'EMPLOYMENT', 'BENEFITS', 'JOB_DESCRIPTION', 'JOB_NOTES', 'OPEN_JOB'];
	$unique['S_COMPANY'] = ['OLD_DSIS_COMPANY_ID', 'PK_PLACEMENT_COMPANY_STATUS', 'PK_PLACEMENT_COMPANY_QUESTION_GROUP', 'COMPANY_NAME', 'DATE_CREATED', 'PK_COMPANY_SOURCE', 'PK_COUNTRY', 'PHONE', 'FAX', 'EMAIL', 'WEBSITE'];
	$unique['S_COMPANY_EVENT'] = ['PK_COMPANY_EVENT', 'PK_PLACEMENT_COMPANY_EVENT_TYPE', 'EVENT_DATE', 'FOLLOW_UP_DATE', 'PK_COMPANY_CONTACT_EMPLOYEE', 'COMPLETE', 'NOTE'];



	$S_STUDENT_SCHEDULE = false;
	$S_STUDENT_JOB = false;
	$S_COMPANY_JOB = false;
	$S_COMPANY = false;
	$S_COMPANY_EVENT = false;
	foreach ($matches[0] as $key => $value) {

		if (preg_match('*.*', $value)) {

			$value = explode('.', $value)[0];
			$S_STUDENT_SCHEDULE = $value == 'S_STUDENT_SCHEDULE' ? true : $S_STUDENT_SCHEDULE;
			$S_STUDENT_JOB = $value == 'S_STUDENT_JOB' ? true : $S_STUDENT_JOB;
			$S_COMPANY_JOB = $value == 'S_COMPANY_JOB' ? true : $S_COMPANY_JOB;
			$S_COMPANY = $value == 'S_COMPANY' ? true : $S_COMPANY;
			$S_COMPANY_EVENT = $value == 'S_COMPANY_EVENT' ? true : $S_COMPANY_EVENT;
		} else {

			if (!in_array($value, ['AND', 'IN'])) {
				$S_STUDENT_SCHEDULE = in_array($value, $unique['S_STUDENT_SCHEDULE']) ? true : $S_STUDENT_SCHEDULE;
				$S_STUDENT_JOB = in_array($value, $unique['S_STUDENT_JOB']) ? true : $S_STUDENT_JOB;
				$S_COMPANY_JOB = in_array($value, $unique['S_COMPANY_JOB']) ? true : $S_COMPANY_JOB;
				$S_COMPANY = in_array($value, $unique['S_COMPANY']) ? true : $S_COMPANY;
				$S_COMPANY_EVENT = in_array($value, $unique['S_COMPANY_EVENT']) ? true : $S_COMPANY_EVENT;
			}
		}
	}

	$djoins = '';
	if ($S_STUDENT_SCHEDULE)
		$djoins .= ' LEFT JOIN S_STUDENT_SCHEDULE ON S_STUDENT_SCHEDULE.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ';
	if ($S_STUDENT_JOB)
		$djoins .= ' LEFT JOIN S_STUDENT_JOB ON S_STUDENT_JOB.PK_STUDENT_ENROLLMENT = S_STUDENT_ENROLLMENT.PK_STUDENT_ENROLLMENT ';
	if ($S_COMPANY_JOB)
		$djoins .= ' LEFT JOIN S_COMPANY_JOB ON S_COMPANY_JOB.PK_COMPANY_JOB = S_STUDENT_JOB.PK_COMPANY_JOB ';
	if ($S_COMPANY)
		$djoins .= ' LEFT JOIN S_COMPANY ON S_COMPANY.PK_COMPANY = S_COMPANY_JOB.PK_COMPANY ';
	if ($S_COMPANY_EVENT)
		$djoins .= ' LEFT JOIN S_COMPANY_EVENT ON S_COMPANY_EVENT.PK_COMPANY = S_COMPANY.PK_COMPANY ';

	return $djoins;
}
